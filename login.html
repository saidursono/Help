<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡¶∏‡¶Æ‡¶æ‡¶ú ‡¶ï‡¶≤‡ßç‡¶Ø‡¶æ‡¶£ ‡¶Ø‡ßÅ‡¶¨ ‡¶∏‡¶Ç‡¶ó‡¶†‡¶® ‚Äî ‡¶≤‡¶ó‡¶á‡¶® / ‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶®</title>
<link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{
  --g1:#061a06;--g2:#0d2e0d;--g3:#1b6b1b;--g4:#2e8b2e;--g5:#43a843;
  --gold:#f0b429;--sgold:#ffd966;--dgold:#c8940a;
  --glass:rgba(255,255,255,0.07);--glass2:rgba(255,255,255,0.12);--glass3:rgba(255,255,255,0.18);
  --b1:rgba(255,255,255,0.15);--b2:rgba(240,180,41,0.35);
  --blur:blur(18px);--text:#e8f5e8;--text2:#a5d6a7;--text3:#ffd966;
}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Hind Siliguri',sans-serif;background:var(--g1);color:var(--text);min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:20px;overflow-x:hidden;}
body::before{content:'';position:fixed;inset:0;z-index:0;pointer-events:none;
  background:radial-gradient(ellipse 70% 60% at 15% 20%,rgba(46,139,46,.28),transparent 65%),
    radial-gradient(ellipse 55% 70% at 85% 75%,rgba(27,107,27,.22),transparent 65%);}
.orb{position:fixed;border-radius:50%;pointer-events:none;z-index:0;}
.o1{width:420px;height:420px;top:-120px;right:-120px;background:radial-gradient(circle,rgba(240,180,41,.1),transparent 70%);animation:ofl 22s ease-in-out infinite;}
.o2{width:320px;height:320px;bottom:-100px;left:-100px;background:radial-gradient(circle,rgba(46,139,46,.18),transparent 70%);animation:ofl 28s ease-in-out infinite reverse;}
@keyframes ofl{0%,100%{transform:translateY(0)}40%{transform:translateY(-30px)}70%{transform:translateY(15px)}}

.container{position:relative;z-index:1;width:100%;max-width:520px;}
.logo-area{text-align:center;margin-bottom:28px;animation:fu .7s ease both;}
.logo-img{width:80px;height:80px;border-radius:50%;border:3px solid var(--gold);box-shadow:0 0 30px rgba(240,180,41,.4);object-fit:cover;margin-bottom:12px;}
.logo-title{color:var(--sgold);font-size:1.2rem;font-weight:700;}
.logo-sub{color:var(--text2);font-size:13px;}
@keyframes fu{from{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}

/* TAB SYSTEM */
.tabs{display:flex;background:var(--glass);border:1px solid var(--b1);border-radius:14px;padding:4px;margin-bottom:24px;}
.tab{flex:1;padding:10px;text-align:center;border-radius:10px;cursor:pointer;font-size:14px;font-weight:600;color:rgba(255,255,255,.5);transition:all .25s;border:none;background:none;font-family:inherit;}
.tab.active{background:linear-gradient(135deg,var(--gold),var(--sgold));color:var(--g1);}
.tab:not(.active):hover{color:var(--sgold);}

/* CARD */
.card{background:rgba(13,46,13,.9);backdrop-filter:var(--blur);border:1px solid var(--b2);border-radius:20px;padding:32px;animation:fu .7s .1s ease both;}

/* FORM */
.fg{margin-bottom:16px;}
.fg label{display:block;margin-bottom:6px;color:rgba(255,255,255,.8);font-size:14px;font-weight:500;}
.fg label span{color:var(--gold);}
.fg input,.fg select,.fg textarea{width:100%;padding:12px 16px;background:var(--glass2);border:1px solid var(--b1);border-radius:10px;color:#fff;font-size:14px;font-family:inherit;outline:none;transition:border .2s;}
.fg input:focus,.fg select:focus{border-color:var(--b2);}
.fg input::placeholder{color:rgba(255,255,255,.28);}
.fg select option{background:#0d2e0d;color:#fff;}
.fg .hint{font-size:12px;color:rgba(255,255,255,.35);margin-top:5px;}
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:14px;}

/* PHOTO UPLOAD */
.photo-upload{border:2px dashed rgba(240,180,41,.35);border-radius:14px;padding:20px;text-align:center;cursor:pointer;transition:all .3s;position:relative;overflow:hidden;}
.photo-upload:hover{border-color:var(--gold);background:rgba(240,180,41,.05);}
.photo-upload input{position:absolute;inset:0;opacity:0;cursor:pointer;width:100%;height:100%;}
.photo-upload-ico{font-size:2.5rem;margin-bottom:8px;}
.photo-upload p{color:rgba(255,255,255,.5);font-size:13px;}
.photo-upload p strong{color:var(--sgold);}
.photo-preview{width:100%;height:160px;object-fit:cover;border-radius:10px;display:none;}
.photo-name{color:var(--sgold);font-size:12px;margin-top:6px;display:none;}

/* BUTTONS */
.btn-main{width:100%;padding:14px;background:linear-gradient(135deg,var(--gold),var(--sgold));color:var(--g1);border:none;border-radius:12px;font-size:16px;font-weight:700;cursor:pointer;font-family:inherit;transition:all .3s;box-shadow:0 4px 20px rgba(240,180,41,.3);}
.btn-main:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(240,180,41,.42);}
.btn-main:disabled{opacity:.6;cursor:not-allowed;transform:none;}

/* DIVIDER */
.or-div{display:flex;align-items:center;gap:12px;margin:20px 0;}
.or-div::before,.or-div::after{content:'';flex:1;height:1px;background:rgba(255,255,255,.1);}
.or-div span{color:rgba(255,255,255,.3);font-size:13px;}

/* ALERTS */
.alert{padding:12px 16px;border-radius:10px;font-size:13px;margin-bottom:16px;display:none;}
.alert.show{display:block;}
.alert-err{background:rgba(244,67,54,.15);border:1px solid rgba(244,67,54,.35);color:#ff6b6b;}
.alert-ok{background:rgba(76,175,80,.15);border:1px solid rgba(76,175,80,.35);color:#81c784;}
.alert-info{background:rgba(33,150,243,.12);border:1px solid rgba(33,150,243,.3);color:#64b5f6;}

/* PASSWORD TOGGLE */
.pass-wrap{position:relative;}
.pass-wrap input{padding-right:44px;}
.pass-eye{position:absolute;right:12px;top:50%;transform:translateY(-50%);cursor:pointer;color:rgba(255,255,255,.4);font-size:18px;transition:color .2s;}
.pass-eye:hover{color:var(--sgold);}

/* PENDING STATUS */
.pending-box{text-align:center;padding:32px;background:rgba(255,193,7,.08);border:1px solid rgba(255,193,7,.25);border-radius:16px;}
.pending-ico{font-size:3rem;margin-bottom:12px;}
.pending-box h3{color:#ffd54f;font-size:1.2rem;margin-bottom:8px;}
.pending-box p{color:rgba(255,255,255,.6);font-size:14px;line-height:1.8;}

/* PROGRESS */
.upload-progress{display:none;margin-top:8px;}
.upload-progress .bar-track{background:rgba(255,255,255,.1);border-radius:4px;height:6px;overflow:hidden;}
.upload-progress .bar-fill{height:100%;background:linear-gradient(90deg,var(--gold),var(--sgold));border-radius:4px;width:0%;transition:width .3s;}
.upload-progress span{color:var(--text2);font-size:12px;}

/* LINKS */
.link-btn{background:none;border:none;color:var(--sgold);cursor:pointer;font-size:13px;text-decoration:underline;font-family:inherit;}
.back-link{text-align:center;margin-top:20px;}
.back-link a{color:var(--text2);font-size:13px;text-decoration:none;}
.back-link a:hover{color:var(--sgold);}

/* SECTION TITLE */
.sec-title{color:var(--sgold);font-size:.8rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;margin:20px 0 12px;padding-bottom:6px;border-bottom:1px solid rgba(240,180,41,.2);}

@media(max-width:480px){.grid2{grid-template-columns:1fr;gap:0;}.card{padding:22px;}}
</style>
</head>
<body>
<div class="orb o1"></div><div class="orb o2"></div>

<div class="container">
  <!-- LOGO -->
  <div class="logo-area">
    <img class="logo-img" src="https://i.ibb.co.com/XZF23TDY/received-895949380028820.jpg" alt="Logo">
    <div class="logo-title">‡¶∏‡¶Æ‡¶æ‡¶ú ‡¶ï‡¶≤‡ßç‡¶Ø‡¶æ‡¶£ ‡¶Ø‡ßÅ‡¶¨ ‡¶∏‡¶Ç‡¶ó‡¶†‡¶®</div>
    <div class="logo-sub">Somaj Kalyan Jubo Sangathan</div>
  </div>

  <!-- TABS -->
  <div class="tabs">
    <button class="tab active" id="tab-login" onclick="switchTab('login')">üîê ‡¶≤‡¶ó‡¶á‡¶®</button>
    <button class="tab" id="tab-reg" onclick="switchTab('register')">üìù ‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶®</button>
  </div>

  <!-- ‚ïê‚ïê‚ïê LOGIN PANEL ‚ïê‚ïê‚ïê -->
  <div class="card" id="panel-login">
    <div class="alert alert-err" id="login-err"></div>
    <div class="alert alert-ok" id="login-ok"></div>

    <div class="fg">
      <label>üìß ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ <span>*</span></label>
      <input type="email" id="li-email" placeholder="your@email.com">
    </div>
    <div class="fg">
      <label>üîí ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° <span>*</span></label>
      <div class="pass-wrap">
        <input type="password" id="li-pass" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°">
        <span class="pass-eye" onclick="togglePass('li-pass',this)">üëÅ</span>
      </div>
    </div>
    <button class="btn-main" id="login-btn" onclick="doLogin()">üîê ‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    <div class="or-div"><span>‡¶Ö‡¶•‡¶¨‡¶æ</span></div>
    <div style="text-align:center">
      <button class="link-btn" onclick="switchTab('register')">‡¶®‡¶§‡ßÅ‡¶® ‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø? ‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶ï‡¶∞‡ßÅ‡¶® ‚Üí</button>
    </div>
    <div style="text-align:center;margin-top:10px">
      <button class="link-btn" onclick="showForgot()">‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶≠‡ßÅ‡¶≤‡ßá ‡¶ó‡ßá‡¶õ‡ßá‡¶®?</button>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê REGISTER PANEL ‚ïê‚ïê‚ïê -->
  <div class="card" id="panel-register" style="display:none">
    <div class="alert alert-err" id="reg-err"></div>
    <div class="alert alert-ok" id="reg-ok"></div>
    <div class="alert alert-info" id="reg-info" style="display:block">
      üìå ‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶®‡ßá‡¶∞ ‡¶™‡¶∞ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶¨‡ßá‡¶¶‡¶® Admin-‡¶è‡¶∞ ‡¶ï‡¶æ‡¶õ‡ßá ‡¶Ø‡¶æ‡¶¨‡ßá‡•§ Approve ‡¶π‡¶≤‡ßá ‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø ‡¶π‡¶¨‡ßá‡¶®‡•§
    </div>

    <!-- ‡¶õ‡¶¨‡¶ø ‡¶Ü‡¶™‡¶≤‡ßã‡¶° -->
    <div class="fg">
      <label>üì∏ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶õ‡¶¨‡¶ø <span>*</span></label>
      <div class="photo-upload" id="photoUploadBox">
        <input type="file" id="photoInput" accept="image/*" onchange="previewPhoto(this)">
        <div id="photoPlaceholder">
          <div class="photo-upload-ico">üì∑</div>
          <p><strong>‡¶õ‡¶¨‡¶ø ‡¶¨‡ßá‡¶õ‡ßá ‡¶®‡¶ø‡¶®</strong></p>
          <p>JPG, PNG ‚Äî ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö 5MB</p>
        </div>
        <img id="photoPreview" class="photo-preview" alt="Preview">
        <div class="photo-name" id="photoName"></div>
      </div>
      <div class="upload-progress" id="uploadProgress">
        <div class="bar-track"><div class="bar-fill" id="uploadBar"></div></div>
        <span id="uploadTxt">‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</span>
      </div>
    </div>

    <!-- ‡¶¨‡ßç‡¶Ø‡¶ï‡ßç‡¶§‡¶ø‡¶ó‡¶§ ‡¶§‡¶•‡ßç‡¶Ø -->
    <div class="sec-title">üë§ ‡¶¨‡ßç‡¶Ø‡¶ï‡ßç‡¶§‡¶ø‡¶ó‡¶§ ‡¶§‡¶•‡ßç‡¶Ø</div>
    <div class="grid2">
      <div class="fg"><label>‡¶™‡ßÅ‡¶∞‡ßã ‡¶®‡¶æ‡¶Æ <span>*</span></label><input type="text" id="r-name" placeholder="‡¶Æ‡ßã‡¶É/‡¶Æ‡ßã‡¶õ‡¶æ‡¶É..."></div>
      <div class="fg"><label>‡¶ú‡¶®‡ßç‡¶Æ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ <span>*</span></label><input type="date" id="r-dob"></div>
    </div>
    <div class="grid2">
      <div class="fg">
        <label>‡¶≤‡¶ø‡¶ô‡ßç‡¶ó <span>*</span></label>
        <select id="r-gender">
          <option value="">-- ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶® --</option>
          <option>‡¶™‡ßÅ‡¶∞‡ßÅ‡¶∑</option><option>‡¶Æ‡¶π‡¶ø‡¶≤‡¶æ</option><option>‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø</option>
        </select>
      </div>
      <div class="fg">
        <label>‡¶∞‡¶ï‡ßç‡¶§‡ßá‡¶∞ ‡¶ó‡ßç‡¶∞‡ßÅ‡¶™ <span>*</span></label>
        <select id="r-blood">
          <option value="">-- ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶® --</option>
          <option>A+</option><option>A-</option><option>B+</option><option>B-</option>
          <option>AB+</option><option>AB-</option><option>O+</option><option>O-</option>
        </select>
      </div>
    </div>

    <!-- ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó -->
    <div class="sec-title">üìû ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø</div>
    <div class="grid2">
      <div class="fg"><label>‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ <span>*</span></label><input type="tel" id="r-phone" placeholder="01XXXXXXXXX"></div>
      <div class="fg"><label>‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ/‡¶è‡¶≤‡¶æ‡¶ï‡¶æ <span>*</span></label>
        <select id="r-area">
          <option value="">-- ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® --</option>
          <option>‡¶ï‡¶æ‡¶®‡ßç‡¶¶‡¶ø‡¶∞‡¶™‡¶æ‡¶°‡¶º‡¶æ</option><option>‡¶á‡¶®‡¶∏‡¶æ‡¶´ ‡¶®‡¶ó‡¶∞</option><option>‡¶ö‡¶æ‡¶á‡¶°‡ßÅ‡¶¨‡¶æ</option>
          <option>‡¶π‡¶≤‡¶¶‡¶æ‡¶∞ ‡¶™‡¶æ‡¶°‡¶º‡¶æ</option><option>‡¶ö‡¶∞‡¶™‡¶æ‡¶°‡¶º‡¶æ</option><option>‡¶Æ‡ßã‡¶π‡¶æ‡¶Æ‡ßç‡¶Æ‡¶¶‡¶™‡ßÅ‡¶∞</option>
          <option>‡¶®‡¶ø‡¶ö‡¶™‡¶æ‡¶°‡¶º‡¶æ</option><option>‡¶∏‡ßã‡¶®‡¶æ‡¶§‡¶≤‡¶æ</option><option>‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø</option>
        </select>
      </div>
    </div>
    <div class="fg"><label>‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ</label><input type="text" id="r-address" placeholder="‡¶¨‡¶æ‡¶°‡¶º‡¶ø ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞, ‡¶á‡¶â‡¶®‡¶ø‡¶Ø‡¶º‡¶®, ‡¶•‡¶æ‡¶®‡¶æ..."></div>

    <!-- ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü -->
    <div class="sec-title">üîê ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶§‡¶•‡ßç‡¶Ø</div>
    <div class="fg"><label>‡¶á‡¶Æ‡ßá‡¶á‡¶≤ <span>*</span></label><input type="email" id="r-email" placeholder="your@email.com"></div>
    <div class="grid2">
      <div class="fg">
        <label>‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° <span>*</span></label>
        <div class="pass-wrap"><input type="password" id="r-pass" placeholder="‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá ‡ß¨ ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞"><span class="pass-eye" onclick="togglePass('r-pass',this)">üëÅ</span></div>
      </div>
      <div class="fg">
        <label>‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶® <span>*</span></label>
        <div class="pass-wrap"><input type="password" id="r-pass2" placeholder="‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶¶‡¶ø‡¶®"><span class="pass-eye" onclick="togglePass('r-pass2',this)">üëÅ</span></div>
      </div>
    </div>

    <button class="btn-main" id="reg-btn" onclick="doRegister()">üìù ‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    <div style="text-align:center;margin-top:14px">
      <button class="link-btn" onclick="switchTab('login')">‚Üê ‡¶á‡¶§‡¶ø‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶Ü‡¶õ‡ßá? ‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    </div>
  </div>

  <!-- PENDING STATUS BOX (shown after register OR pending login) -->
  <div class="card" id="panel-pending" style="display:none">
    <div class="pending-box">
      <div class="pending-ico">‚è≥</div>
      <h3>‡¶Ü‡¶¨‡ßá‡¶¶‡¶® ‡¶™‡¶∞‡ßç‡¶Ø‡¶æ‡¶≤‡ßã‡¶ö‡¶®‡¶æ‡¶ß‡ßÄ‡¶®</h3>
      <p id="pending-msg">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶ú‡¶Æ‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ Admin ‡¶Ö‡¶®‡ßÅ‡¶Æ‡ßã‡¶¶‡¶®‡ßá‡¶∞ ‡¶™‡¶∞ ‡¶Ü‡¶™‡¶®‡¶ø ‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø ‡¶™‡ßã‡¶∞‡ßç‡¶ü‡¶æ‡¶≤‡ßá ‡¶™‡ßç‡¶∞‡¶¨‡ßá‡¶∂ ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá‡¶®‡•§<br><br>
      ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó: <strong style="color:var(--sgold)">01817-984524</strong></p>
      <button class="btn-main" style="margin-top:20px;max-width:200px;margin-left:auto;margin-right:auto;display:block" onclick="doLogout()">üö™ ‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü</button>
    </div>
  </div>

  <div class="back-link">
    <a href="index.html">‚Üê ‡¶Æ‡ßÇ‡¶≤ ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü‡ßá ‡¶´‡¶ø‡¶∞‡ßÅ‡¶®</a>
  </div>
</div>

<!-- Firebase SDK -->
<script type="module">
import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js';
import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, sendPasswordResetEmail, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js';
import { getFirestore, doc, setDoc, getDoc, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js';

const firebaseConfig = {
  apiKey: "AIzaSyDwzJgWcc4XPt4czcXpVFkHTniJFISpO7I",
  authDomain: "somaj-kallyan.firebaseapp.com",
  projectId: "somaj-kallyan",
  appId: "1:392871962816:web:0f7ebbc36a3d8c784da525"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const SUPER_ADMIN = 'issaidur999@gmail.com';
const CLOUDINARY_URL = 'https://api.cloudinary.com/v1_1/dasurbavl/image/upload';
const UPLOAD_PRESET = 'somaj-kallyan-upload';
const CLOUDINARY_FOLDER = 'somaj-kallyan/members';

// ‚îÄ‚îÄ Check auth state on load
onAuthStateChanged(auth, async (user) => {
  if (user) {
    const userDoc = await getDoc(doc(db, 'users', user.uid));
    if (userDoc.exists()) {
      const data = userDoc.data();
      if (data.status === 'approved') {
        if (data.role === 'superadmin' || data.role === 'admin') {
          window.location.href = 'admin.html';
        } else {
          window.location.href = 'index.html#dashboard';
        }
      } else {
        showPanel('pending');
        document.getElementById('pending-msg').innerHTML =
          `‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶¨‡ßá‡¶¶‡¶® ‡¶™‡¶∞‡ßç‡¶Ø‡¶æ‡¶≤‡ßã‡¶ö‡¶®‡¶æ‡¶ß‡ßÄ‡¶® ‡¶Ü‡¶õ‡ßá‡•§<br>Admin ‡¶Ö‡¶®‡ßÅ‡¶Æ‡ßã‡¶¶‡¶® ‡¶ï‡¶∞‡¶≤‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶∏‡ßá‡¶∏ ‡¶™‡¶æ‡¶¨‡ßá‡¶®‡•§<br><br>
          ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó: <strong style="color:var(--sgold)">01817-984524</strong>`;
      }
    }
  }
});

// ‚îÄ‚îÄ Expose globals
window.doLogin = async function() {
  const email = document.getElementById('li-email').value.trim();
  const pass = document.getElementById('li-pass').value;
  const btn = document.getElementById('login-btn');
  hideAlerts();
  if (!email || !pass) { showErr('login', '‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶ì ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶¶‡¶ø‡¶®‡•§'); return; }
  btn.disabled = true; btn.textContent = '‚è≥ ‡¶≤‡¶ó‡¶á‡¶® ‡¶π‡¶ö‡ßç‡¶õ‡ßá...';
  try {
    const cred = await signInWithEmailAndPassword(auth, email, pass);
    const userDoc = await getDoc(doc(db, 'users', cred.user.uid));
    if (!userDoc.exists()) { showErr('login','‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§'); btn.disabled=false; btn.textContent='üîê ‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®'; return; }
    const data = userDoc.data();
    if (data.status === 'approved') {
      showOk('login', '‚úÖ ‡¶≤‡¶ó‡¶á‡¶® ‡¶∏‡¶´‡¶≤! ‡¶∞‡¶ø‡¶°‡¶æ‡¶á‡¶∞‡ßá‡¶ï‡ßç‡¶ü ‡¶π‡¶ö‡ßç‡¶õ‡ßá...');
      if (data.role === 'superadmin' || data.role === 'admin') {
        setTimeout(() => window.location.href = 'admin.html', 1200);
      } else {
        setTimeout(() => window.location.href = 'index.html', 1200);
      }
    } else {
      showPanel('pending');
    }
  } catch(e) {
    btn.disabled = false; btn.textContent = 'üîê ‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®';
    const msg = e.code === 'auth/invalid-credential' ? '‚ùå ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶¨‡¶æ ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶≠‡ßÅ‡¶≤‡•§' :
                e.code === 'auth/user-not-found' ? '‚ùå ‡¶è‡¶á ‡¶á‡¶Æ‡ßá‡¶á‡¶≤‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶®‡ßá‡¶á‡•§' :
                e.code === 'auth/too-many-requests' ? '‚ö†Ô∏è ‡¶Ö‡¶®‡ßá‡¶ï‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶ï‡¶ø‡¶õ‡ßÅ‡¶ï‡ßç‡¶∑‡¶£ ‡¶™‡¶∞‡ßá ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§' : '‚ùå ' + e.message;
    showErr('login', msg);
  }
};

window.doRegister = async function() {
  const name = document.getElementById('r-name').value.trim();
  const dob = document.getElementById('r-dob').value;
  const gender = document.getElementById('r-gender').value;
  const blood = document.getElementById('r-blood').value;
  const phone = document.getElementById('r-phone').value.trim();
  const area = document.getElementById('r-area').value;
  const address = document.getElementById('r-address').value.trim();
  const email = document.getElementById('r-email').value.trim();
  const pass = document.getElementById('r-pass').value;
  const pass2 = document.getElementById('r-pass2').value;
  const photoFile = document.getElementById('photoInput').files[0];

  hideAlerts();

  // Validation
  if (!photoFile) { showErr('reg', 'üì∏ ‡¶õ‡¶¨‡¶ø ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®‡•§'); return; }
  if (!name || !dob || !gender || !blood || !phone || !area || !email || !pass) { showErr('reg', '‚ö†Ô∏è ‡¶∏‡¶¨ ‡¶§‡¶æ‡¶∞‡¶ï‡¶æ (*) ‡¶ö‡¶ø‡¶π‡ßç‡¶®‡¶ø‡¶§ ‡¶ò‡¶∞ ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§'); return; }
  if (pass !== pass2) { showErr('reg', '‚ùå ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶¶‡ßÅ‡¶ü‡¶ø ‡¶Æ‡¶ø‡¶≤‡¶õ‡ßá ‡¶®‡¶æ‡•§'); return; }
  if (pass.length < 6) { showErr('reg', '‚ö†Ô∏è ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá ‡ß¨ ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞‡ßá‡¶∞ ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§'); return; }
  if (!/^01[0-9]{9}$/.test(phone.replace(/-/g,''))) { showErr('reg', '‚ö†Ô∏è ‡¶∏‡¶†‡¶ø‡¶ï ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂‡¶ø ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶¶‡¶ø‡¶®‡•§'); return; }

  const btn = document.getElementById('reg-btn');
  btn.disabled = true; btn.textContent = '‚è≥ ‡¶™‡ßç‡¶∞‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ ‡¶ö‡¶≤‡¶õ‡ßá...';

  try {
    // 1. Upload photo to Cloudinary
    btn.textContent = 'üì∏ ‡¶õ‡¶¨‡¶ø ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...';
    const photoUrl = await uploadToCloudinary(photoFile);

    // 2. Create Firebase Auth user
    btn.textContent = 'üîê ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡¶ö‡ßç‡¶õ‡ßá...';
    const cred = await createUserWithEmailAndPassword(auth, email, pass);

    // 3. Save user data to Firestore
    const year = new Date().getFullYear();
    await setDoc(doc(db, 'users', cred.user.uid), {
      uid: cred.user.uid,
      name, dob, gender, bloodGroup: blood,
      phone, area, address, email,
      photoUrl,
      role: 'member',
      status: 'pending',
      memberId: null, // Assigned by admin when approved
      position: '‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø',
      createdAt: serverTimestamp(),
      updatedAt: serverTimestamp(),
    });

    // 4. Create pending request
    await setDoc(doc(db, 'pendingRequests', cred.user.uid), {
      uid: cred.user.uid, name, phone, area, email, photoUrl,
      status: 'pending', createdAt: serverTimestamp()
    });

    showPanel('pending');
    document.getElementById('pending-msg').innerHTML =
      `üéâ ‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶∏‡¶´‡¶≤ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!<br><br>
      ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶¨‡ßá‡¶¶‡¶® Admin-‡¶è‡¶∞ ‡¶ï‡¶æ‡¶õ‡ßá ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶Ö‡¶®‡ßÅ‡¶Æ‡ßã‡¶¶‡¶® ‡¶™‡ßá‡¶≤‡ßá SMS ‡¶¨‡¶æ ‡¶´‡ßã‡¶®‡ßá ‡¶ú‡¶æ‡¶®‡¶æ‡¶®‡ßã ‡¶π‡¶¨‡ßá‡•§<br><br>
      ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó: <strong style="color:var(--sgold)">01817-984524</strong>`;
  } catch(e) {
    btn.disabled = false; btn.textContent = 'üìù ‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®';
    const msg = e.code === 'auth/email-already-in-use' ? '‚ùå ‡¶è‡¶á ‡¶á‡¶Æ‡ßá‡¶á‡¶≤‡ßá ‡¶Ü‡¶ó‡ßá‡¶á ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶Ü‡¶õ‡ßá‡•§' :
                e.code === 'auth/invalid-email' ? '‚ùå ‡¶∏‡¶†‡¶ø‡¶ï ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶¶‡¶ø‡¶®‡•§' : '‚ùå ' + e.message;
    showErr('reg', msg);
  }
};

window.doLogout = function() { signOut(auth).then(() => { showPanel('login'); switchTab('login'); }); };

window.showForgot = async function() {
  const email = document.getElementById('li-email').value.trim();
  if (!email) { showErr('login', '‚ö†Ô∏è ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®‡•§'); return; }
  try {
    await sendPasswordResetEmail(auth, email);
    showOk('login', '‚úÖ ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤‡ßá ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§');
  } catch(e) { showErr('login', '‚ùå ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§'); }
};

// ‚îÄ‚îÄ Cloudinary Upload
async function uploadToCloudinary(file) {
  return new Promise((resolve, reject) => {
    const formData = new FormData();
    formData.append('file', file);
    formData.append('upload_preset', UPLOAD_PRESET);
    formData.append('folder', CLOUDINARY_FOLDER);

    const xhr = new XMLHttpRequest();
    xhr.open('POST', CLOUDINARY_URL);

    const progress = document.getElementById('uploadProgress');
    const bar = document.getElementById('uploadBar');
    const txt = document.getElementById('uploadTxt');
    progress.style.display = 'block';

    xhr.upload.onprogress = (e) => {
      if (e.lengthComputable) {
        const pct = Math.round((e.loaded / e.total) * 100);
        bar.style.width = pct + '%';
        txt.textContent = `‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá... ${pct}%`;
      }
    };
    xhr.onload = () => {
      if (xhr.status === 200) {
        const res = JSON.parse(xhr.responseText);
        txt.textContent = '‚úÖ ‡¶õ‡¶¨‡¶ø ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶∏‡¶´‡¶≤!';
        resolve(res.secure_url);
      } else {
        progress.style.display = 'none';
        reject(new Error('‡¶õ‡¶¨‡¶ø ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•‡•§'));
      }
    };
    xhr.onerror = () => { progress.style.display = 'none'; reject(new Error('‡¶õ‡¶¨‡¶ø ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•‡•§')); };
    xhr.send(formData);
  });
}
</script>

<script>
function switchTab(tab) {
  document.getElementById('panel-login').style.display = tab === 'login' ? 'block' : 'none';
  document.getElementById('panel-register').style.display = tab === 'register' ? 'block' : 'none';
  document.getElementById('panel-pending').style.display = 'none';
  document.getElementById('tab-login').classList.toggle('active', tab === 'login');
  document.getElementById('tab-reg').classList.toggle('active', tab === 'register');
}

function showPanel(panel) {
  document.getElementById('panel-login').style.display = 'none';
  document.getElementById('panel-register').style.display = 'none';
  document.getElementById('panel-pending').style.display = 'none';
  document.getElementById('tabs') && (document.querySelector('.tabs').style.display = panel === 'pending' ? 'none' : '');
  if (panel === 'pending') document.querySelector('.tabs').style.display = 'none';
  else document.querySelector('.tabs').style.display = 'flex';
  document.getElementById('panel-' + panel).style.display = 'block';
}

function togglePass(id, el) {
  const inp = document.getElementById(id);
  inp.type = inp.type === 'password' ? 'text' : 'password';
  el.textContent = inp.type === 'password' ? 'üëÅ' : 'üôà';
}

function previewPhoto(input) {
  if (input.files && input.files[0]) {
    const file = input.files[0];
    if (file.size > 5 * 1024 * 1024) { alert('‡¶õ‡¶¨‡¶ø 5MB ‡¶è‡¶∞ ‡¶¨‡ßá‡¶∂‡¶ø ‡¶π‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá ‡¶®‡¶æ‡•§'); input.value=''; return; }
    const reader = new FileReader();
    reader.onload = (e) => {
      const prev = document.getElementById('photoPreview');
      prev.src = e.target.result;
      prev.style.display = 'block';
      document.getElementById('photoPlaceholder').style.display = 'none';
      document.getElementById('photoName').textContent = '‚úÖ ' + file.name;
      document.getElementById('photoName').style.display = 'block';
    };
    reader.readAsDataURL(file);
  }
}

function showErr(form, msg) {
  const el = document.getElementById(form + '-err');
  el.textContent = msg; el.classList.add('show');
}

function showOk(form, msg) {
  const el = document.getElementById(form + '-ok');
  el.textContent = msg; el.classList.add('show');
}

function hideAlerts() {
  document.querySelectorAll('.alert').forEach(a => { a.classList.remove('show'); a.textContent=''; });
  document.getElementById('reg-info') && (document.getElementById('reg-info').style.display='block');
}
</script>
</body>
</html>