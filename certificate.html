<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>à¦¸à¦¾à¦°à§à¦Ÿà¦¿à¦«à¦¿à¦•à§‡à¦Ÿ à¦“ ID à¦•à¦¾à¦°à§à¦¡ â€” à¦¸à¦®à¦¾à¦œ à¦•à¦²à§à¦¯à¦¾à¦£ à¦¯à§à¦¬ à¦¸à¦‚à¦—à¦ à¦¨</title>
<link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;500;600;700&family=Cinzel:wght@400;600;700;900&family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400;1,600&family=Montserrat:wght@400;600;700;900&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
:root {
  --black:#0a0a0a; --dark:#111111; --dark2:#1a1a1a;
  --gold:#c9a84c; --gold2:#e8c878; --gold3:#f5e0a0; --gold-dark:#8b6914;
  --white:#ffffff; --offwhite:#fafaf8; --cream:#fdf8ee;
  --green:#1b5e20; --green2:#2e7d32; --green3:#43a047;
  --blur:blur(20px);
  --shadow:0 20px 60px rgba(0,0,0,0.4);
}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Hind Siliguri',sans-serif;background:var(--dark);color:var(--white);min-height:100vh;overflow-x:hidden;}

/* LOADER */
#loader{position:fixed;inset:0;z-index:9999;background:var(--black);display:flex;flex-direction:column;align-items:center;justify-content:center;}
.ld-ring{width:56px;height:56px;border-radius:50%;border:2px solid rgba(201,168,76,.15);border-top:2px solid var(--gold);animation:spin .8s linear infinite;}
.ld-txt{color:var(--gold2);margin-top:12px;font-size:12px;letter-spacing:2px;opacity:.7;}
@keyframes spin{to{transform:rotate(360deg)}}
@keyframes fadeUp{from{transform:translateY(30px);opacity:0}to{transform:translateY(0);opacity:1}}
@keyframes shimmer{0%{background-position:-200% center}100%{background-position:200% center}}
@keyframes pulse2{0%,100%{box-shadow:0 0 0 0 rgba(201,168,76,0.3)}50%{box-shadow:0 0 0 8px rgba(201,168,76,0)}}

/* NAV */
nav{position:fixed;top:0;left:0;right:0;z-index:1000;background:rgba(10,10,10,0.95);backdrop-filter:var(--blur);border-bottom:1px solid rgba(201,168,76,0.2);}
.nav-in{max-width:1200px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;height:60px;padding:0 24px;}
.brand{display:flex;align-items:center;gap:10px;text-decoration:none;}
.brand-logo{width:38px;height:38px;border-radius:50%;border:1.5px solid var(--gold);overflow:hidden;}
.brand-logo img{width:100%;height:100%;object-fit:cover;}
.brand-txt{line-height:1.2;}
.brand-txt strong{display:block;color:var(--gold2);font-size:12px;font-weight:700;letter-spacing:.5px;}
.brand-txt span{color:rgba(255,255,255,.4);font-size:10px;}
.nav-right{display:flex;align-items:center;gap:10px;}
.nav-back{padding:7px 16px;border-radius:6px;background:rgba(201,168,76,.08);border:1px solid rgba(201,168,76,.25);color:var(--gold2);font-size:12px;font-weight:600;cursor:pointer;text-decoration:none;transition:all .2s;letter-spacing:.5px;}
.nav-back:hover{background:rgba(201,168,76,.15);}
.nav-user{display:none;align-items:center;gap:8px;padding:5px 12px;background:rgba(201,168,76,.08);border:1px solid rgba(201,168,76,.2);border-radius:6px;}
.nav-av{width:26px;height:26px;border-radius:50%;border:1.5px solid var(--gold);overflow:hidden;background:var(--dark2);display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:700;color:var(--gold);}
.nav-av img{width:100%;height:100%;object-fit:cover;}
.nav-name{color:var(--gold2);font-size:12px;font-weight:600;}

/* HERO */
.hero{padding:100px 20px 50px;text-align:center;position:relative;overflow:hidden;}
.hero::before{content:'';position:absolute;inset:0;background:radial-gradient(ellipse 80% 60% at 50% 0%, rgba(201,168,76,0.06), transparent 70%);}
.hero-eyebrow{display:inline-flex;align-items:center;gap:8px;padding:5px 18px;border-radius:20px;background:rgba(201,168,76,.08);border:1px solid rgba(201,168,76,.2);color:var(--gold2);font-size:11px;font-weight:600;letter-spacing:2px;margin-bottom:20px;text-transform:uppercase;}
.hero-title{font-family:'Cinzel',serif;font-size:clamp(2rem,5vw,3.5rem);font-weight:700;color:var(--white);line-height:1.1;margin-bottom:10px;}
.hero-title span{background:linear-gradient(135deg,var(--gold),var(--gold2),var(--gold3));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;}
.hero-sub{color:rgba(255,255,255,.45);font-size:14px;letter-spacing:1px;}
.hero-line{width:60px;height:2px;background:linear-gradient(90deg,transparent,var(--gold),transparent);margin:20px auto 0;}

/* NOT LOGGED IN */
#notLoggedIn{display:none;max-width:460px;margin:0 auto;padding:0 20px 60px;}
.nli-box{background:var(--dark2);border:1px solid rgba(201,168,76,.2);border-radius:16px;padding:48px 36px;text-align:center;}
.nli-ico{font-size:3rem;margin-bottom:16px;}
.nli-box h3{color:var(--gold2);font-family:'Cinzel',serif;font-size:1.3rem;margin-bottom:10px;}
.nli-box p{color:rgba(255,255,255,.5);font-size:14px;line-height:1.8;margin-bottom:24px;}
.btn-login{display:inline-block;padding:13px 36px;background:linear-gradient(135deg,var(--gold-dark),var(--gold),var(--gold2));color:var(--black);border-radius:8px;font-size:14px;font-weight:700;text-decoration:none;letter-spacing:.5px;transition:all .3s;}
.btn-login:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(201,168,76,.4);}

/* MAIN */
#mainContent{display:none;max-width:1100px;margin:0 auto;padding:0 20px 80px;}

/* USER CARD */
.user-card{background:linear-gradient(135deg,rgba(26,26,26,0.9),rgba(20,20,20,0.9));backdrop-filter:var(--blur);border:1px solid rgba(201,168,76,.2);border-radius:16px;padding:24px;margin-bottom:32px;display:flex;align-items:center;gap:20px;animation:fadeUp .6s ease both;position:relative;overflow:hidden;}
.user-card::before{content:'';position:absolute;top:0;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,var(--gold),transparent);}
.user-av{width:72px;height:72px;border-radius:50%;border:2px solid var(--gold);overflow:hidden;background:var(--dark2);display:flex;align-items:center;justify-content:center;font-size:1.8rem;font-weight:700;color:var(--gold);flex-shrink:0;animation:pulse2 3s infinite;}
.user-av img{width:100%;height:100%;object-fit:cover;}
.user-info h2{color:var(--white);font-size:1.1rem;font-weight:700;margin-bottom:4px;}
.user-info p{color:rgba(255,255,255,.45);font-size:12px;line-height:1.8;}
.user-badge{display:inline-block;margin-top:6px;padding:3px 12px;border-radius:20px;background:rgba(201,168,76,.1);border:1px solid rgba(201,168,76,.25);color:var(--gold2);font-size:11px;font-weight:600;letter-spacing:.5px;}
.user-status{margin-left:auto;text-align:right;flex-shrink:0;}
.status-dot{width:8px;height:8px;border-radius:50%;background:#4caf50;display:inline-block;margin-right:5px;}
.status-txt{color:#66bb6a;font-size:12px;font-weight:600;}

/* TABS */
.tabs{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:28px;animation:fadeUp .6s .1s ease both;opacity:0;animation-fill-mode:forwards;}
.tab{padding:9px 20px;border-radius:8px;cursor:pointer;border:1px solid rgba(255,255,255,.08);background:rgba(255,255,255,.03);color:rgba(255,255,255,.45);font-family:inherit;font-size:12px;font-weight:600;transition:all .25s;letter-spacing:.5px;}
.tab:hover{border-color:rgba(201,168,76,.3);color:var(--gold2);background:rgba(201,168,76,.06);}
.tab.active{background:linear-gradient(135deg,rgba(201,168,76,.15),rgba(201,168,76,.05));border-color:rgba(201,168,76,.4);color:var(--gold2);}

/* SECTIONS */
.cert-section{display:none;animation:fadeUp .4s ease both;}
.cert-section.active{display:block;}

/* PREVIEW WRAP */
.preview-wrap{background:rgba(15,15,15,0.6);border:1px solid rgba(255,255,255,.06);border-radius:16px;padding:28px;margin-bottom:16px;}
.canvas-wrap{display:flex;justify-content:center;margin-bottom:20px;}
canvas.cert-canvas{max-width:100%;border-radius:10px;box-shadow:0 24px 80px rgba(0,0,0,.6),0 0 60px rgba(201,168,76,.08);}

/* DOWNLOAD BTNS */
.dl-btns{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;}
.dl-btn{display:flex;align-items:center;gap:8px;padding:11px 24px;border-radius:8px;font-size:13px;font-weight:700;cursor:pointer;border:none;font-family:inherit;transition:all .25s;letter-spacing:.5px;}
.dl-pdf{background:linear-gradient(135deg,#c62828,#e53935);color:#fff;}
.dl-pdf:hover{transform:translateY(-2px);box-shadow:0 6px 24px rgba(229,57,53,.4);}
.dl-jpg{background:linear-gradient(135deg,var(--gold-dark),var(--gold),var(--gold2));color:var(--black);}
.dl-jpg:hover{transform:translateY(-2px);box-shadow:0 6px 24px rgba(201,168,76,.4);}

/* INFO GRID */
.info-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:10px;margin-top:16px;}
.info-item{padding:12px 14px;background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.06);border-radius:10px;display:flex;align-items:center;gap:10px;}
.info-ico{font-size:1rem;opacity:.8;}
.info-txt strong{display:block;color:var(--gold2);font-size:10px;letter-spacing:.5px;margin-bottom:2px;text-transform:uppercase;}
.info-txt span{color:rgba(255,255,255,.75);font-size:13px;}

/* PENDING */
.pending{text-align:center;padding:48px 24px;background:rgba(255,193,7,.04);border:1px solid rgba(255,193,7,.15);border-radius:16px;}
.pending .ico{font-size:3rem;margin-bottom:14px;}
.pending h4{color:#ffd54f;font-size:1.1rem;font-weight:700;margin-bottom:8px;}
.pending p{color:rgba(255,255,255,.5);font-size:14px;line-height:1.8;}

/* FOOTER */
footer{background:rgba(10,10,10,.9);border-top:1px solid rgba(201,168,76,.1);padding:20px;text-align:center;}
footer p{color:rgba(255,255,255,.2);font-size:11px;}
footer a{color:rgba(201,168,76,.5);text-decoration:none;font-weight:600;}
footer a:hover{color:var(--gold);}

@media(max-width:640px){
  .user-card{flex-direction:column;text-align:center;}
  .user-status{margin-left:0;text-align:center;}
  .tabs{justify-content:center;}
}
</style>
</head>
<body>

<div id="loader"><div class="ld-ring"></div><div class="ld-txt">à¦²à§‹à¦¡ à¦¹à¦šà§à¦›à§‡...</div></div>

<nav>
  <div class="nav-in">
    <a class="brand" href="index.html">
      <div class="brand-logo"><img src="https://i.ibb.co.com/XZF23TDY/received-895949380028820.jpg" alt="à¦²à§‹à¦—à§‹"></div>
      <div class="brand-txt"><strong>à¦¸à¦®à¦¾à¦œ à¦•à¦²à§à¦¯à¦¾à¦£ à¦¯à§à¦¬ à¦¸à¦‚à¦—à¦ à¦¨</strong><span>Somaj Kalyan Jubo Sangathan</span></div>
    </a>
    <div class="nav-right">
      <a class="nav-back" href="index.html">â† à¦®à§‚à¦² à¦ªà§‡à¦œ</a>
      <div class="nav-user" id="navUser">
        <div class="nav-av" id="navAv"></div>
        <span class="nav-name" id="navName">...</span>
      </div>
    </div>
  </div>
</nav>

<div class="hero">
  <div class="hero-eyebrow">ğŸ† à¦¸à¦¾à¦°à§à¦Ÿà¦¿à¦«à¦¿à¦•à§‡à¦Ÿ à¦ªà§‹à¦°à§à¦Ÿà¦¾à¦²</div>
  <h1 class="hero-title"><span>à¦¸à¦¾à¦°à§à¦Ÿà¦¿à¦«à¦¿à¦•à§‡à¦Ÿ</span> à¦“ ID à¦•à¦¾à¦°à§à¦¡</h1>
  <p class="hero-sub">Certificates & Identity Card â€” à¦¸à¦®à¦¾à¦œ à¦•à¦²à§à¦¯à¦¾à¦£ à¦¯à§à¦¬ à¦¸à¦‚à¦—à¦ à¦¨</p>
  <div class="hero-line"></div>
</div>

<!-- NOT LOGGED IN -->
<div id="notLoggedIn">
  <div class="nli-box">
    <div class="nli-ico">ğŸ”</div>
    <h3>à¦²à¦—à¦‡à¦¨ à¦•à¦°à§à¦¨</h3>
    <p>à¦¸à¦¾à¦°à§à¦Ÿà¦¿à¦«à¦¿à¦•à§‡à¦Ÿ à¦“ ID à¦•à¦¾à¦°à§à¦¡ à¦¦à§‡à¦–à¦¤à§‡ à¦à¦¬à¦‚ à¦¡à¦¾à¦‰à¦¨à¦²à§‹à¦¡ à¦•à¦°à¦¤à§‡ à¦†à¦ªà¦¨à¦¾à¦•à§‡ à¦²à¦—à¦‡à¦¨ à¦•à¦°à¦¤à§‡ à¦¹à¦¬à§‡à¥¤</p>
    <a href="login.html" class="btn-login">à¦²à¦—à¦‡à¦¨ à¦•à¦°à§à¦¨</a>
  </div>
</div>

<!-- MAIN CONTENT -->
<div id="mainContent">

  <!-- USER CARD -->
  <div class="user-card">
    <div class="user-av" id="bigAv"></div>
    <div class="user-info">
      <h2 id="uName">-</h2>
      <p id="uInfo">-</p>
      <span class="user-badge" id="uBadge">à¦¸à¦¦à¦¸à§à¦¯</span>
      <span style="display:block;color:rgba(201,168,76,.6);font-size:11px;margin-top:4px" id="uId"></span>
    </div>
    <div class="user-status">
      <div><span class="status-dot"></span><span class="status-txt">à¦…à¦¨à§à¦®à§‹à¦¦à¦¿à¦¤ à¦¸à¦¦à¦¸à§à¦¯</span></div>
    </div>
  </div>

  <!-- TABS -->
  <div class="tabs">
    <button class="tab active" onclick="showCert('membership',this)">ğŸ… à¦¸à¦¦à¦¸à§à¦¯à¦ªà¦¦ à¦¸à¦¾à¦°à§à¦Ÿà¦¿à¦«à¦¿à¦•à§‡à¦Ÿ</button>
    <button class="tab" onclick="showCert('idcard',this)">ğŸªª ID à¦•à¦¾à¦°à§à¦¡</button>
    <button class="tab" onclick="showCert('volunteer',this)">ğŸ™‹ à¦¸à§à¦¬à§‡à¦šà§à¦›à¦¾à¦¸à§‡à¦¬à§€ à¦¸à¦¾à¦°à§à¦Ÿà¦¿à¦«à¦¿à¦•à§‡à¦Ÿ</button>
    <button class="tab" onclick="showCert('participation',this)">ğŸ¯ à¦…à¦‚à¦¶à¦—à§à¦°à¦¹à¦£ à¦¸à¦¾à¦°à§à¦Ÿà¦¿à¦«à¦¿à¦•à§‡à¦Ÿ</button>
  </div>

  <!-- MEMBERSHIP -->
  <div class="cert-section active" id="sec-membership">
    <div class="preview-wrap">
      <div class="canvas-wrap"><canvas id="membershipCanvas" class="cert-canvas" width="1122" height="794"></canvas></div>
      <div class="dl-btns">
        <button class="dl-btn dl-pdf" onclick="downloadCert('membership','pdf')">ğŸ“„ PDF à¦¡à¦¾à¦‰à¦¨à¦²à§‹à¦¡</button>
        <button class="dl-btn dl-jpg" onclick="downloadCert('membership','jpg')">ğŸ–¼ï¸ JPG à¦¡à¦¾à¦‰à¦¨à¦²à§‹à¦¡</button>
      </div>
    </div>
    <div class="info-grid" id="membershipInfo"></div>
  </div>

  <!-- ID CARD -->
  <div class="cert-section" id="sec-idcard">
    <div class="preview-wrap">
      <div class="canvas-wrap"><canvas id="idCanvas" class="cert-canvas" width="1016" height="638"></canvas></div>
      <div class="dl-btns">
        <button class="dl-btn dl-pdf" onclick="downloadCert('idcard','pdf')">ğŸ“„ PDF à¦¡à¦¾à¦‰à¦¨à¦²à§‹à¦¡</button>
        <button class="dl-btn dl-jpg" onclick="downloadCert('idcard','jpg')">ğŸ–¼ï¸ JPG à¦¡à¦¾à¦‰à¦¨à¦²à§‹à¦¡</button>
      </div>
    </div>
    <div class="info-grid" id="idInfo"></div>
  </div>

  <!-- VOLUNTEER -->
  <div class="cert-section" id="sec-volunteer">
    <div class="preview-wrap">
      <div class="canvas-wrap"><canvas id="volunteerCanvas" class="cert-canvas" width="1122" height="794"></canvas></div>
      <div class="dl-btns">
        <button class="dl-btn dl-pdf" onclick="downloadCert('volunteer','pdf')">ğŸ“„ PDF à¦¡à¦¾à¦‰à¦¨à¦²à§‹à¦¡</button>
        <button class="dl-btn dl-jpg" onclick="downloadCert('volunteer','jpg')">ğŸ–¼ï¸ JPG à¦¡à¦¾à¦‰à¦¨à¦²à§‹à¦¡</button>
      </div>
    </div>
  </div>

  <!-- PARTICIPATION -->
  <div class="cert-section" id="sec-participation">
    <div class="preview-wrap">
      <div class="canvas-wrap"><canvas id="participationCanvas" class="cert-canvas" width="1122" height="794"></canvas></div>
      <div class="dl-btns">
        <button class="dl-btn dl-pdf" onclick="downloadCert('participation','pdf')">ğŸ“„ PDF à¦¡à¦¾à¦‰à¦¨à¦²à§‹à¦¡</button>
        <button class="dl-btn dl-jpg" onclick="downloadCert('participation','jpg')">ğŸ–¼ï¸ JPG à¦¡à¦¾à¦‰à¦¨à¦²à§‹à¦¡</button>
      </div>
    </div>
  </div>

</div><!-- /mainContent -->

<footer>
  <p>Â© à§¨à§¦à§¨à§«â€“à§¨à§¦à§¨à§¬ à¦¸à¦®à¦¾à¦œ à¦•à¦²à§à¦¯à¦¾à¦£ à¦¯à§à¦¬ à¦¸à¦‚à¦—à¦ à¦¨ Â· à¦°à¦¾à¦®à¦•à§ƒà¦·à§à¦£à¦ªà§à¦°, à¦¦à§Œà¦²à¦¤à¦ªà§à¦°, à¦•à§à¦·à§à¦Ÿà¦¿à¦¯à¦¼à¦¾</p>
  <p style="margin-top:6px">ğŸ› ï¸ Developed by <a href="https://saidursono.github.io/Saidur/" target="_blank">Saidur</a></p>
</footer>

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HELPERS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function bnNum(n){return n.toString().replace(/\d/g,d=>'à§¦à§§à§¨à§©à§ªà§«à§¬à§­à§®à§¯'[d]);}
function ini(nm){return(nm||'?').replace('à¦®à§‹à¦ƒ ','').replace('à¦®à§‹à¦›à¦¾à¦ƒ ','').trim().charAt(0);}
function todayBn(){const d=new Date();return`${bnNum(d.getDate())} ${['à¦œà¦¾à¦¨à§à¦¯à¦¼à¦¾à¦°à¦¿','à¦«à§‡à¦¬à§à¦°à§à¦¯à¦¼à¦¾à¦°à¦¿','à¦®à¦¾à¦°à§à¦š','à¦à¦ªà§à¦°à¦¿à¦²','à¦®à§‡','à¦œà§à¦¨','à¦œà§à¦²à¦¾à¦‡','à¦†à¦—à¦¸à§à¦Ÿ','à¦¸à§‡à¦ªà§à¦Ÿà§‡à¦®à§à¦¬à¦°','à¦…à¦•à§à¦Ÿà§‹à¦¬à¦°','à¦¨à¦­à§‡à¦®à§à¦¬à¦°','à¦¡à¦¿à¦¸à§‡à¦®à§à¦¬à¦°'][d.getMonth()]} ${bnNum(d.getFullYear())}`;}
function todayEn(){return new Date().toLocaleDateString('en-GB',{day:'numeric',month:'long',year:'numeric'});}
function wrapText(c,text,x,y,maxW,lineH){
  const words=text.split(' ');let line='';
  for(const w of words){const t=line+w+' ';if(c.measureText(t).width>maxW&&line!==''){c.fillText(line.trim(),x,y);line=w+' ';y+=lineH;}else line=t;}
  c.fillText(line.trim(),x,y);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   GOLD GRADIENT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function goldGrd(c,x1,y1,x2,y2){
  const g=c.createLinearGradient(x1,y1,x2,y2);
  g.addColorStop(0,'#8b6914');g.addColorStop(0.3,'#c9a84c');
  g.addColorStop(0.5,'#f5e0a0');g.addColorStop(0.7,'#c9a84c');
  g.addColorStop(1,'#8b6914');
  return g;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DRAW DECORATIVE CORNER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function drawCorner(c,x,y,size,grd,fx=false,fy=false){
  c.save();c.translate(x,y);if(fx)c.scale(-1,1);if(fy)c.scale(1,-1);
  c.strokeStyle=grd;c.lineWidth=1.5;
  c.beginPath();c.moveTo(0,size*.6);c.lineTo(0,0);c.lineTo(size*.6,0);c.stroke();
  c.beginPath();c.arc(0,0,size*.25,0,Math.PI/2);c.stroke();
  c.restore();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DRAW SIGNATURE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function drawSig(c,x,y,role,name,grd,w=160){
  c.strokeStyle=grd;c.lineWidth=1;
  c.beginPath();c.moveTo(x-w/2,y);c.lineTo(x+w/2,y);c.stroke();
  c.fillStyle='#1b4d20';c.font='bold 13px "Hind Siliguri"';
  c.textAlign='center';c.textBaseline='alphabetic';
  c.fillText(role,x,y+17);
  c.fillStyle='#555';c.font='12px "Hind Siliguri"';
  c.fillText(name,x,y+32);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DRAW OFFICIAL SEAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function drawSeal(c,cx,cy,r,grd){
  c.save();c.globalAlpha=0.18;
  // Outer ring
  c.strokeStyle=grd;c.lineWidth=3;
  c.beginPath();c.arc(cx,cy,r,0,Math.PI*2);c.stroke();
  c.beginPath();c.arc(cx,cy,r-6,0,Math.PI*2);c.stroke();
  // Star pattern
  c.fillStyle='#b8860b';
  for(let i=0;i<8;i++){
    const a=i*Math.PI/4;const rx=cx+Math.cos(a)*(r-14);const ry=cy+Math.sin(a)*(r-14);
    c.beginPath();c.arc(rx,ry,2,0,Math.PI*2);c.fill();
  }
  c.font=`bold ${Math.round(r*.24)}px "Hind Siliguri"`;
  c.fillStyle='#1b4d20';c.textAlign='center';c.textBaseline='middle';
  c.fillText('à¦¸à¦®à¦¾à¦œ à¦•à¦²à§à¦¯à¦¾à¦£',cx,cy-8);
  c.fillText('à¦¸à§€à¦²',cx,cy+10);
  c.restore();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DEVELOPER CREDIT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function devCredit(c,W,H){
  c.save();c.globalAlpha=0.18;
  c.fillStyle='#8b6914';c.font='bold 13px Montserrat, Arial';
  c.textAlign='right';c.textBaseline='bottom';
  c.fillText('Developed by Saidur',W-46,H-46);
  c.restore();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   QR CODE (simple visual pattern)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function drawQR(c,x,y,size,memberId){
  const cell=size/10;
  // Outer frame
  c.fillStyle='#111';c.fillRect(x,y,size,size);
  c.fillStyle='#fff';c.fillRect(x+cell,y+cell,size-cell*2,size-cell*2);
  // Corner squares
  function sq(cx,cy,s){
    c.fillStyle='#111';c.fillRect(cx,cy,s,s);
    c.fillStyle='#fff';c.fillRect(cx+cell*.4,cy+cell*.4,s-cell*.8,s-cell*.8);
    c.fillStyle='#111';c.fillRect(cx+cell,cy+cell,s-cell*2,s-cell*2);
  }
  sq(x+cell,y+cell,cell*3);
  sq(x+size-cell*4,y+cell,cell*3);
  sq(x+cell,y+size-cell*4,cell*3);
  // Data cells (pseudo-random based on memberId)
  const seed=(memberId||'').split('').reduce((a,b)=>a+b.charCodeAt(0),0)||42;
  for(let i=3;i<8;i++){for(let j=3;j<8;j++){
    if((seed*(i+1)*(j+2))%7<3){
      c.fillStyle='#111';
      c.fillRect(x+i*cell,y+j*cell,cell*.8,cell*.8);
    }
  }}
  for(let i=0;i<10;i++){
    const px=(seed*(i*3+1))%8+1;const py=(seed*(i*5+2))%8+1;
    if(px>4||py<3||py>7){c.fillStyle='#111';c.fillRect(x+px*cell,y+py*cell,cell*.8,cell*.8);}
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   1. MEMBERSHIP CERTIFICATE  (A4 Landscape 1122Ã—794)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function drawMembership(m,photo){
  const canvas=document.getElementById('membershipCanvas');
  const c=canvas.getContext('2d');
  const W=1122,H=794;
  c.clearRect(0,0,W,H);

  // â”€â”€ Background: warm cream parchment
  const bgGrd=c.createLinearGradient(0,0,W,H);
  bgGrd.addColorStop(0,'#fefdf6');bgGrd.addColorStop(0.5,'#fffef9');bgGrd.addColorStop(1,'#faf8ed');
  c.fillStyle=bgGrd;c.fillRect(0,0,W,H);

  // â”€â”€ Subtle texture dots
  c.save();c.globalAlpha=0.018;
  for(let i=0;i<W;i+=28){for(let j=0;j<H;j+=28){
    c.fillStyle='#b8860b';c.beginPath();c.arc(i,j,1.2,0,Math.PI*2);c.fill();
  }}
  c.restore();

  // â”€â”€ Outer border (thick gold)
  const grd=goldGrd(c,0,0,W,H);
  c.strokeStyle=grd;c.lineWidth=14;c.strokeRect(7,7,W-14,H-14);
  // â”€â”€ Inner border (thin gold)
  c.strokeStyle=grd;c.lineWidth=2;c.strokeRect(24,24,W-48,H-48);
  // â”€â”€ Innermost border (green)
  c.strokeStyle='rgba(27,93,32,0.25)';c.lineWidth=1;c.strokeRect(32,32,W-64,H-64);

  // â”€â”€ Corner ornaments
  const cs=40;
  drawCorner(c,28,28,cs,grd);drawCorner(c,W-28,28,cs,grd,true);
  drawCorner(c,28,H-28,cs,grd,false,true);drawCorner(c,W-28,H-28,cs,grd,true,true);

  // â”€â”€ Left green ribbon strip
  const lRib=c.createLinearGradient(0,0,0,H);
  lRib.addColorStop(0,'#1b5e20');lRib.addColorStop(0.5,'#2e7d32');lRib.addColorStop(1,'#1b5e20');
  c.fillStyle=lRib;c.fillRect(38,38,7,H-76);

  // â”€â”€ Right green ribbon strip
  c.fillStyle=lRib;c.fillRect(W-45,38,7,H-76);

  // â”€â”€ Header section background
  const hBg=c.createLinearGradient(50,38,50,175);
  hBg.addColorStop(0,'rgba(27,93,32,0.07)');hBg.addColorStop(1,'rgba(27,93,32,0)');
  c.fillStyle=hBg;c.fillRect(50,38,W-100,137);

  // â”€â”€ Logo circle (left)
  const lx=110,ly=106,lr=50;
  c.save();
  c.beginPath();c.arc(lx,ly,lr,0,Math.PI*2);
  c.fillStyle='#1b5e20';c.fill();
  c.strokeStyle=grd;c.lineWidth=3;c.stroke();
  c.restore();
  c.fillStyle='#ffd700';c.font='bold 10px "Hind Siliguri"';
  c.textAlign='center';c.textBaseline='middle';
  c.fillText('à¦¸à¦‚à¦—à¦ à¦¨',lx,ly-6);c.fillText('à¦²à§‹à¦—à§‹',lx,ly+8);

  // â”€â”€ Org name (center header)
  c.textAlign='center';c.textBaseline='alphabetic';
  c.fillStyle='#1b5e20';c.font='bold 30px "Hind Siliguri"';
  c.fillText('à¦¸à¦®à¦¾à¦œ à¦•à¦²à§à¦¯à¦¾à¦£ à¦¯à§à¦¬ à¦¸à¦‚à¦—à¦ à¦¨',W/2,80);
  c.fillStyle='#8b6914';c.font='italic 13px "Cormorant Garamond", Georgia';
  c.fillText('Somaj Kalyan Jubo Sangathan Â· Ramkrisnopur, Doulatpur, Kushtia Â· Est. 2025',W/2,100);

  // â”€â”€ Developed By (header sub)
  c.fillStyle='rgba(139,105,20,0.55)';c.font='600 11px Montserrat, Arial';
  c.fillText('Developed By Saidur',W/2,118);

  // â”€â”€ Divider with ornament
  c.strokeStyle=grd;c.lineWidth=1;
  c.beginPath();c.moveTo(65,135);c.lineTo(W/2-50,135);c.stroke();
  c.fillStyle='#b8860b';c.font='18px serif';c.textAlign='center';c.fillText('â–',W/2,140);
  c.beginPath();c.moveTo(W/2+50,135);c.lineTo(W-65,135);c.stroke();

  // â”€â”€ Certificate title
  c.fillStyle='#1a1200';c.font='bold 38px Cinzel, serif';c.textAlign='center';
  c.fillText('CERTIFICATE OF MEMBERSHIP',W/2,196);
  c.fillStyle='#8b6914';c.font='bold 20px "Hind Siliguri"';
  c.fillText('à¦¸à¦¦à¦¸à§à¦¯à¦ªà¦¦ à¦¸à¦¾à¦°à§à¦Ÿà¦¿à¦«à¦¿à¦•à§‡à¦Ÿ',W/2,224);

  // â”€â”€ Title underline
  const tLine=c.createLinearGradient(200,0,W-200,0);
  tLine.addColorStop(0,'transparent');tLine.addColorStop(0.2,'#c9a84c');
  tLine.addColorStop(0.5,'#f5e0a0');tLine.addColorStop(0.8,'#c9a84c');tLine.addColorStop(1,'transparent');
  c.strokeStyle=tLine;c.lineWidth=2;
  c.beginPath();c.moveTo(200,237);c.lineTo(W-200,237);c.stroke();

  // â”€â”€ Body left side
  const bx=65;
  c.textAlign='left';c.textBaseline='alphabetic';
  c.fillStyle='#444';c.font='15px "Hind Siliguri"';
  c.fillText('à¦à¦Ÿà¦¿ à¦ªà§à¦°à¦®à¦¾à¦£ à¦•à¦°à¦¾ à¦¹à¦šà§à¦›à§‡ à¦¯à§‡,',bx,278);
  c.fillStyle='#666';c.font='italic 13px "Cormorant Garamond",Georgia';
  c.fillText('This is to certify that,',bx,296);

  // â”€â”€ Member name
  c.fillStyle='#1b5e20';c.font='bold 34px "Hind Siliguri"';
  c.fillText(m.name||'-',bx,346);
  const nw=c.measureText(m.name||'-').width;
  c.strokeStyle=grd;c.lineWidth=2;
  c.beginPath();c.moveTo(bx,353);c.lineTo(bx+nw,353);c.stroke();

  // â”€â”€ Member details
  c.fillStyle='#3a3a3a';c.font='14px "Hind Siliguri"';
  c.fillText(`à¦ªà§‡à¦¶à¦¾ / Occupation: ${m.job||'â€”'}`,bx,383);
  c.fillText(`à¦¶à¦¿à¦•à§à¦·à¦¾ / Education: ${m.education||'â€”'}`,bx,405);
  c.fillText(`à¦—à§à¦°à¦¾à¦® / Village: ${m.area||m.village||'â€”'}`,bx,427);
  c.fillText(`à¦®à§‹à¦¬à¦¾à¦‡à¦² / Mobile: ${m.phone||'â€”'}`,bx,449);
  c.fillText(`à¦°à¦•à§à¦¤à§‡à¦° à¦—à§à¦°à§à¦ª / Blood Group: ${m.bloodGroup||'â€”'}`,bx,471);

  // â”€â”€ Main paragraph
  c.fillStyle='#333';c.font='13.5px "Hind Siliguri"';
  wrapText(c,'à¦¸à¦®à¦¾à¦œ à¦•à¦²à§à¦¯à¦¾à¦£ à¦¯à§à¦¬ à¦¸à¦‚à¦—à¦ à¦¨à§‡à¦° à¦à¦•à¦œà¦¨ à¦¨à¦¿à¦¬à§‡à¦¦à¦¿à¦¤à¦ªà§à¦°à¦¾à¦£ à¦¸à¦¦à¦¸à§à¦¯ à¦¹à¦¿à¦¸à§‡à¦¬à§‡ à¦¸à§à¦¬à§€à¦•à§ƒà¦¤ à¦à¦¬à¦‚ à¦¸à¦‚à¦—à¦ à¦¨à§‡à¦° à¦¸à¦•à¦² à¦•à¦¾à¦°à§à¦¯à¦•à§à¦°à¦®à§‡ à¦¸à¦•à§à¦°à¦¿à¦¯à¦¼à¦­à¦¾à¦¬à§‡ à¦…à¦‚à¦¶à¦—à§à¦°à¦¹à¦£ à¦•à¦°à§‡à¦¨à¥¤',bx,497,570,21);
  c.fillStyle='#666';c.font='italic 12px "Cormorant Garamond",Georgia';
  wrapText(c,'is recognized as a dedicated member of Somaj Kalyan Jubo Sangathan and actively participates in all organizational activities.',bx,524,570,18);

  // â”€â”€ Member ID & Date
  c.fillStyle='#1b5e20';c.font='bold 14px "Hind Siliguri"';
  c.fillText(`à¦¸à¦¦à¦¸à§à¦¯ à¦¨à¦®à§à¦¬à¦°: ${m.memberId||'â€”'}`,bx,562);
  c.fillStyle='#555';c.font='13px "Hind Siliguri"';
  c.fillText(`à¦¤à¦¾à¦°à¦¿à¦–: ${todayBn()}  /  Date: ${todayEn()}`,bx,582);

  // â”€â”€ Photo (right)
  const pX=W-148,pY=390,pR=80;
  c.save();c.beginPath();c.arc(pX,pY,pR,0,Math.PI*2);c.clip();
  if(photo){c.drawImage(photo,pX-pR,pY-pR,pR*2,pR*2);}
  else{
    c.fillStyle='#e8f5e8';c.fillRect(pX-pR,pY-pR,pR*2,pR*2);
    c.fillStyle='#1b5e20';c.font=`bold 58px "Hind Siliguri"`;
    c.textAlign='center';c.textBaseline='middle';c.fillText(ini(m.name),pX,pY+3);
  }
  c.restore();
  c.strokeStyle=grd;c.lineWidth=4;c.beginPath();c.arc(pX,pY,pR+2,0,Math.PI*2);c.stroke();
  c.strokeStyle='rgba(184,134,11,0.25)';c.lineWidth=1.5;c.beginPath();c.arc(pX,pY,pR+10,0,Math.PI*2);c.stroke();

  // â”€â”€ QR Code
  drawQR(c,W-208,490,80,m.memberId);
  c.fillStyle='#888';c.font='10px Arial';c.textAlign='center';
  c.fillText('Scan QR',W-168,578);

  // â”€â”€ Signatures
  drawSig(c,100,700,'à¦¸à¦­à¦¾à¦ªà¦¤à¦¿','à¦®à§‹à¦ƒ à¦¶à¦¿à¦®à§à¦² à¦¹à§‹à¦¸à§‡à¦¨',grd);
  drawSig(c,390,700,'à¦¸à¦¾à¦§à¦¾à¦°à¦£ à¦¸à¦®à§à¦ªà¦¾à¦¦à¦•','à¦®à§‹à¦ƒ à¦œà¦¾à¦•à¦¿à¦° à¦¹à§‹à¦¸à§‡à¦¨',grd);
  drawSig(c,680,700,'à¦¸à¦¾à¦§à¦¾à¦°à¦£ à¦¸à¦®à§à¦ªà¦¾à¦¦à¦•','à¦®à§‹à¦ƒ à¦¶à§à¦­ à¦†à¦²à§€',grd);

  // â”€â”€ Seal
  drawSeal(c,W-148,630,48,grd);

  // â”€â”€ Footer strip
  const fg=c.createLinearGradient(0,H-42,0,H-20);
  fg.addColorStop(0,'#1b5e20');fg.addColorStop(1,'#0d3311');
  c.fillStyle=fg;c.fillRect(50,H-42,W-100,24);
  c.fillStyle='rgba(245,224,160,0.9)';c.font='11px "Hind Siliguri"';
  c.textAlign='center';c.textBaseline='middle';
  c.fillText('à¦¸à§‡à¦¬à¦¾à¦¯à¦¼ à¦¨à¦¿à¦¬à§‡à¦¦à¦¿à¦¤, à¦‰à¦¨à§à¦¨à¦¯à¦¼à¦¨à§‡ à¦ªà§à¦°à¦¤à¦¿à¦¶à§à¦°à§à¦¤à¦¿à¦¬à¦¦à§à¦§  Â·  Dedicated to Service, Committed to Development',W/2,H-30);

  devCredit(c,W,H);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   2. ID CARD  (1016Ã—638 â€” styled like reference image)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function drawIDCard(m,photo){
  const canvas=document.getElementById('idCanvas');
  const c=canvas.getContext('2d');
  const W=1016,H=638;
  c.clearRect(0,0,W,H);

  // â”€â”€ FRONT CARD (full canvas)
  // Background: dark
  c.fillStyle='#111111';c.fillRect(0,0,W,H);

  // â”€â”€ Top dark section (2/3 of height)
  const topBg=c.createLinearGradient(0,0,W,0);
  topBg.addColorStop(0,'#1a1a1a');topBg.addColorStop(0.5,'#222222');topBg.addColorStop(1,'#1a1a1a');
  c.fillStyle=topBg;c.fillRect(0,0,W,H*.62);

  // â”€â”€ Gold bottom bar (diagonal cut like reference)
  c.save();
  c.beginPath();
  c.moveTo(0,H*.58);c.lineTo(W*.38,H*.58);
  c.lineTo(W*.48,H);c.lineTo(0,H);c.closePath();
  c.fillStyle='#c9a84c';c.fill();
  c.restore();

  c.save();
  c.beginPath();
  c.moveTo(W*.38,H*.58);c.lineTo(W,H*.58);
  c.lineTo(W,H);c.lineTo(W*.48,H);c.closePath();
  c.fillStyle='#c9a84c';c.fill();
  c.restore();

  // â”€â”€ Gold outer border
  const grd=goldGrd(c,0,0,W,H);
  c.strokeStyle=grd;c.lineWidth=5;c.strokeRect(2.5,2.5,W-5,H-5);

  // â”€â”€ Gold diamond logo mark (top center, like reference)
  const dmx=W/2,dmy=60;
  c.save();c.translate(dmx,dmy);c.rotate(Math.PI/4);
  c.strokeStyle=goldGrd(c,-20,-20,20,20);c.lineWidth=2.5;
  c.strokeRect(-18,-18,36,36);
  c.restore();
  // Inner diamond
  c.save();c.translate(dmx,dmy);c.rotate(Math.PI/4);
  c.strokeStyle='rgba(201,168,76,0.4)';c.lineWidth=1;
  c.strokeRect(-10,-10,20,20);c.restore();

  // â”€â”€ Org name (top center)
  c.fillStyle='#ffffff';c.font='bold 18px Cinzel, serif';
  c.textAlign='center';c.textBaseline='alphabetic';
  c.fillText('à¦¸à¦®à¦¾à¦œ à¦•à¦²à§à¦¯à¦¾à¦£ à¦¯à§à¦¬ à¦¸à¦‚à¦—à¦ à¦¨',W/2,116);
  c.fillStyle='rgba(201,168,76,0.7)';c.font='11px "Cormorant Garamond",Georgia';
  c.fillText('Somaj Kalyan Jubo Sangathan Â· Est. 2025',W/2,134);

  // â”€â”€ Developed By (below org name)
  c.fillStyle='rgba(201,168,76,0.4)';c.font='600 10px Montserrat, Arial';
  c.fillText('Developed By Saidur',W/2,150);

  // â”€â”€ Gold divider line
  c.strokeStyle=goldGrd(c,100,0,W-100,0);c.lineWidth=1;
  c.beginPath();c.moveTo(80,162);c.lineTo(W-80,162);c.stroke();

  // â”€â”€ Photo (left side)
  const pX=140,pY=310,pR=90;
  // Photo shadow/glow
  c.save();c.shadowColor='rgba(201,168,76,0.4)';c.shadowBlur=20;
  c.beginPath();c.arc(pX,pY,pR+4,0,Math.PI*2);
  c.strokeStyle=grd;c.lineWidth=3;c.stroke();c.restore();
  // Clip & draw photo
  c.save();c.beginPath();c.arc(pX,pY,pR,0,Math.PI*2);c.clip();
  if(photo){c.drawImage(photo,pX-pR,pY-pR,pR*2,pR*2);}
  else{
    const initBg=c.createRadialGradient(pX,pY,0,pX,pY,pR);
    initBg.addColorStop(0,'#2e7d32');initBg.addColorStop(1,'#1b5e20');
    c.fillStyle=initBg;c.fillRect(pX-pR,pY-pR,pR*2,pR*2);
    c.fillStyle='#ffd700';c.font='bold 64px Arial';
    c.textAlign='center';c.textBaseline='middle';c.fillText(ini(m.name),pX,pY+4);
  }
  c.restore();

  // â”€â”€ Member name (right of photo)
  c.fillStyle='#ffffff';c.font='bold 26px "Hind Siliguri"';
  c.textAlign='left';c.textBaseline='alphabetic';
  c.fillText(m.name||'-',W*.32,220);

  // â”€â”€ Position/role
  c.fillStyle='rgba(201,168,76,0.85)';c.font='600 14px Montserrat, Arial';
  c.fillText((m.position||'à¦¸à¦¦à¦¸à§à¦¯').toUpperCase(),W*.32,244);

  // â”€â”€ Info rows (right side)
  const rx=W*.32;
  const rows=[
    ['ğŸ“','Mobile / à¦®à§‹à¦¬à¦¾à¦‡à¦²',m.phone||'â€”'],
    ['ğŸ“','Village / à¦—à§à¦°à¦¾à¦®',m.area||m.village||'â€”'],
    ['ğŸ’¼','Occupation / à¦ªà§‡à¦¶à¦¾',m.job||'â€”'],
    ['ğŸ“','Education / à¦¶à¦¿à¦•à§à¦·à¦¾',m.education||'â€”'],
    ['ğŸ©¸','Blood Group / à¦°à¦•à§à¦¤à§‡à¦° à¦—à§à¦°à§à¦ª',m.bloodGroup||'â€”'],
  ];
  rows.forEach(([ico,label,val],i)=>{
    const ry=280+i*52;
    c.fillStyle='rgba(255,255,255,.28)';c.font='10px Arial';
    c.fillText(`${ico}  ${label}`,rx,ry);
    c.fillStyle='#ffffff';c.font='bold 14px "Hind Siliguri"';
    c.fillText(val,rx+4,ry+18);
    // divider
    if(i<rows.length-1){
      c.strokeStyle='rgba(255,255,255,0.07)';c.lineWidth=1;
      c.beginPath();c.moveTo(rx,ry+30);c.lineTo(W-60,ry+30);c.stroke();
    }
  });

  // â”€â”€ QR Code (bottom left of info area)
  drawQR(c,W-156,440,80,m.memberId);
  c.fillStyle='rgba(255,255,255,.35)';c.font='10px Arial';
  c.textAlign='center';c.fillText('SCAN',W-116,526);

  // â”€â”€ Member ID badge (on gold bar)
  c.fillStyle='#111';c.font='bold 15px Montserrat, Arial';
  c.textAlign='left';c.textBaseline='alphabetic';
  c.fillText('ID: '+(m.memberId||'â€”'),65,H-22);

  // â”€â”€ Ramkrisnopur text on gold bar
  c.fillStyle='#111';c.font='11px "Hind Siliguri"';
  c.textAlign='center';
  c.fillText('à¦°à¦¾à¦®à¦•à§ƒà¦·à§à¦£à¦ªà§à¦°, à¦¦à§Œà¦²à¦¤à¦ªà§à¦°, à¦•à§à¦·à§à¦Ÿà¦¿à¦¯à¦¼à¦¾',W/2,H-22);

  // â”€â”€ Bottom right: contact
  c.fillStyle='rgba(0,0,0,0.6)';c.font='10px Arial';
  c.textAlign='right';
  c.fillText('01817-984524',W-65,H-22);

  devCredit(c,W,H-48);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   3. VOLUNTEER CERTIFICATE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function drawVolunteer(m,photo){
  const canvas=document.getElementById('volunteerCanvas');
  const c=canvas.getContext('2d');
  const W=1122,H=794;
  c.clearRect(0,0,W,H);

  // BG
  const bg=c.createLinearGradient(0,0,W,H);
  bg.addColorStop(0,'#f6fef6');bg.addColorStop(1,'#edf8ed');
  c.fillStyle=bg;c.fillRect(0,0,W,H);

  // Subtle radial overlay
  c.save();c.globalAlpha=0.04;
  c.beginPath();c.arc(-80,-80,700,0,Math.PI*2);
  c.fillStyle='#2e7d32';c.fill();
  c.restore();

  // Borders
  const grd=goldGrd(c,0,0,W,H);
  c.strokeStyle='#2e7d32';c.lineWidth=14;c.strokeRect(7,7,W-14,H-14);
  c.strokeStyle=grd;c.lineWidth=2.5;c.strokeRect(22,22,W-44,H-44);
  c.strokeStyle='rgba(46,125,50,0.2)';c.lineWidth=1;c.strokeRect(30,30,W-60,H-60);

  const cs=38;
  drawCorner(c,28,28,cs,grd);drawCorner(c,W-28,28,cs,grd,true);
  drawCorner(c,28,H-28,cs,grd,false,true);drawCorner(c,W-28,H-28,cs,grd,true,true);

  // Header
  c.fillStyle='#1b5e20';c.font='bold 28px "Hind Siliguri"';
  c.textAlign='center';c.textBaseline='alphabetic';
  c.fillText('à¦¸à¦®à¦¾à¦œ à¦•à¦²à§à¦¯à¦¾à¦£ à¦¯à§à¦¬ à¦¸à¦‚à¦—à¦ à¦¨',W/2,76);
  c.fillStyle='#8b6914';c.font='italic 13px "Cormorant Garamond",Georgia';
  c.fillText('Somaj Kalyan Jubo Sangathan Â· Ramkrisnopur, Doulatpur, Kushtia Â· Est. 2025',W/2,96);
  c.fillStyle='rgba(139,105,20,0.5)';c.font='600 11px Montserrat,Arial';
  c.fillText('Developed By Saidur',W/2,112);

  c.strokeStyle=grd;c.lineWidth=1;
  c.beginPath();c.moveTo(70,126);c.lineTo(W-70,126);c.stroke();

  // Badge icon
  c.font='52px serif';c.fillStyle='#2e7d32';
  c.textBaseline='middle';c.fillText('ğŸ™‹',W/2,172);c.textBaseline='alphabetic';

  // Title
  c.fillStyle='#0a3d0a';c.font='bold 36px Cinzel,serif';
  c.textAlign='center';c.fillText('VOLUNTEER CERTIFICATE',W/2,228);
  c.fillStyle='#8b6914';c.font='bold 20px "Hind Siliguri"';
  c.fillText('à¦¸à§à¦¬à§‡à¦šà§à¦›à¦¾à¦¸à§‡à¦¬à§€ à¦¸à¦¾à¦°à§à¦Ÿà¦¿à¦«à¦¿à¦•à§‡à¦Ÿ',W/2,256);

  const tl=c.createLinearGradient(100,0,W-100,0);
  tl.addColorStop(0,'transparent');tl.addColorStop(0.3,'#c9a84c');
  tl.addColorStop(0.7,'#c9a84c');tl.addColorStop(1,'transparent');
  c.strokeStyle=tl;c.lineWidth=1.5;
  c.beginPath();c.moveTo(100,269);c.lineTo(W-100,269);c.stroke();

  // Body
  const bx=68;
  c.textAlign='left';c.fillStyle='#444';c.font='15px "Hind Siliguri"';
  c.fillText('à¦¸à¦¶à§à¦°à¦¦à§à¦§à§‡ à¦ªà§à¦°à¦®à¦¾à¦£ à¦•à¦°à¦¾ à¦¹à¦šà§à¦›à§‡ à¦¯à§‡,  /  This is to certify with honor that,',bx,306);

  c.fillStyle='#1b5e20';c.font='bold 32px "Hind Siliguri"';
  c.fillText(m.name||'-',bx,356);
  const nw=c.measureText(m.name||'-').width;
  c.strokeStyle=grd;c.lineWidth=2;
  c.beginPath();c.moveTo(bx,363);c.lineTo(bx+nw,363);c.stroke();

  c.fillStyle='#3a3a3a';c.font='14px "Hind Siliguri"';
  c.fillText(`à¦ªà§‡à¦¶à¦¾: ${m.job||'â€”'}  Â·  à¦¶à¦¿à¦•à§à¦·à¦¾: ${m.education||'â€”'}`,bx,390);
  c.fillText(`à¦—à§à¦°à¦¾à¦®: ${m.area||m.village||'â€”'}  Â·  à¦®à§‹à¦¬à¦¾à¦‡à¦²: ${m.phone||'â€”'}`,bx,412);

  c.fillStyle='#333';c.font='13.5px "Hind Siliguri"';
  wrapText(c,'à¦¸à¦®à¦¾à¦œ à¦•à¦²à§à¦¯à¦¾à¦£ à¦¯à§à¦¬ à¦¸à¦‚à¦—à¦ à¦¨à§‡à¦° à¦à¦•à¦œà¦¨ à¦¨à¦¿à¦·à§à¦ à¦¾à¦¬à¦¾à¦¨ à¦¸à§à¦¬à§‡à¦šà§à¦›à¦¾à¦¸à§‡à¦¬à§€ à¦¹à¦¿à¦¸à§‡à¦¬à§‡ à¦¸à¦‚à¦—à¦ à¦¨à§‡à¦° à¦¬à¦¿à¦­à¦¿à¦¨à§à¦¨ à¦¸à¦®à¦¾à¦œà¦¸à§‡à¦¬à¦¾à¦®à§‚à¦²à¦• à¦•à¦¾à¦°à§à¦¯à¦•à§à¦°à¦® à¦¯à§‡à¦®à¦¨ à¦¬à§ƒà¦•à§à¦·à¦°à§‹à¦ªà¦£, à¦¶à¦¿à¦•à§à¦·à¦¾ à¦¸à¦¹à¦¾à¦¯à¦¼à¦¤à¦¾, à¦°à¦•à§à¦¤à¦¦à¦¾à¦¨, à¦¤à§à¦°à¦¾à¦£ à¦¬à¦¿à¦¤à¦°à¦£ à¦‡à¦¤à§à¦¯à¦¾à¦¦à¦¿à¦¤à§‡ à¦¸à¦•à§à¦°à¦¿à¦¯à¦¼à¦­à¦¾à¦¬à§‡ à¦…à¦¬à¦¦à¦¾à¦¨ à¦°à§‡à¦–à§‡à¦›à§‡à¦¨à¥¤',bx,440,590,21);
  c.fillStyle='#666';c.font='italic 12px "Cormorant Garamond",Georgia';
  wrapText(c,'has served as a dedicated volunteer of Somaj Kalyan Jubo Sangathan, actively contributing to tree plantation, education support, blood donation, relief distribution and other social welfare activities.',bx,494,590,18);

  c.fillStyle='#1b5e20';c.font='bold 13px "Hind Siliguri"';
  c.fillText(`à¦¸à¦¦à¦¸à§à¦¯ ID: ${m.memberId||'â€”'}`,bx,546);
  c.fillStyle='#555';c.font='13px "Hind Siliguri"';
  c.fillText(`à¦¤à¦¾à¦°à¦¿à¦–: ${todayBn()}  /  Date: ${todayEn()}`,bx,566);

  // Photo right
  const pX=W-148,pY=420,pR=78;
  c.save();c.beginPath();c.arc(pX,pY,pR,0,Math.PI*2);c.clip();
  if(photo){c.drawImage(photo,pX-pR,pY-pR,pR*2,pR*2);}
  else{c.fillStyle='#e8f5e8';c.fillRect(pX-pR,pY-pR,pR*2,pR*2);c.fillStyle='#1b5e20';c.font='bold 56px Arial';c.textAlign='center';c.textBaseline='middle';c.fillText(ini(m.name),pX,pY+3);}
  c.restore();
  c.strokeStyle=grd;c.lineWidth=4;c.beginPath();c.arc(pX,pY,pR+2,0,Math.PI*2);c.stroke();
  c.strokeStyle='rgba(46,125,50,0.2)';c.lineWidth=1.5;c.beginPath();c.arc(pX,pY,pR+10,0,Math.PI*2);c.stroke();

  drawQR(c,W-200,510,72,m.memberId);

  drawSig(c,100,704,'à¦¸à¦­à¦¾à¦ªà¦¤à¦¿','à¦®à§‹à¦ƒ à¦¶à¦¿à¦®à§à¦² à¦¹à§‹à¦¸à§‡à¦¨',grd);
  drawSig(c,390,704,'à¦¸à¦¾à¦§à¦¾à¦°à¦£ à¦¸à¦®à§à¦ªà¦¾à¦¦à¦•','à¦®à§‹à¦ƒ à¦œà¦¾à¦•à¦¿à¦° à¦¹à§‹à¦¸à§‡à¦¨',grd);
  drawSig(c,680,704,'à¦¸à¦¾à¦§à¦¾à¦°à¦£ à¦¸à¦®à§à¦ªà¦¾à¦¦à¦•','à¦®à§‹à¦ƒ à¦¶à§à¦­ à¦†à¦²à§€',grd);
  drawSeal(c,W-148,644,46,grd);

  const fg=c.createLinearGradient(0,H-42,0,H-18);
  fg.addColorStop(0,'#1b5e20');fg.addColorStop(1,'#0d3311');
  c.fillStyle=fg;c.fillRect(38,H-42,W-76,24);
  c.fillStyle='rgba(245,224,160,0.9)';c.font='11px "Hind Siliguri"';
  c.textAlign='center';c.textBaseline='middle';
  c.fillText('à¦¸à§‡à¦¬à¦¾à¦¯à¦¼ à¦¨à¦¿à¦¬à§‡à¦¦à¦¿à¦¤, à¦‰à¦¨à§à¦¨à¦¯à¦¼à¦¨à§‡ à¦ªà§à¦°à¦¤à¦¿à¦¶à§à¦°à§à¦¤à¦¿à¦¬à¦¦à§à¦§  Â·  Dedicated to Service, Committed to Development',W/2,H-30);

  devCredit(c,W,H);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   4. PARTICIPATION CERTIFICATE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function drawParticipation(m,photo){
  const canvas=document.getElementById('participationCanvas');
  const c=canvas.getContext('2d');
  const W=1122,H=794;
  c.clearRect(0,0,W,H);

  // BG warm ivory
  const bg=c.createLinearGradient(0,0,W,H);
  bg.addColorStop(0,'#fffdf0');bg.addColorStop(1,'#faf8e8');
  c.fillStyle=bg;c.fillRect(0,0,W,H);

  // Subtle gold dots texture
  c.save();c.globalAlpha=0.022;
  for(let i=0;i<W;i+=50){for(let j=0;j<H;j+=50){
    c.fillStyle='#daa520';c.beginPath();c.arc(i,j,10,0,Math.PI*2);c.fill();
  }}
  c.restore();

  const grd=goldGrd(c,0,0,W,H);
  // Triple border
  c.strokeStyle=grd;c.lineWidth=11;c.strokeRect(6,6,W-12,H-12);
  c.strokeStyle='#1b5e20';c.lineWidth=3;c.strokeRect(20,20,W-40,H-40);
  c.strokeStyle=grd;c.lineWidth=1;c.strokeRect(30,30,W-60,H-60);

  const cs=38;
  drawCorner(c,28,28,cs,grd);drawCorner(c,W-28,28,cs,grd,true);
  drawCorner(c,28,H-28,cs,grd,false,true);drawCorner(c,W-28,H-28,cs,grd,true,true);

  // Header
  c.fillStyle='#1b5e20';c.font='bold 27px "Hind Siliguri"';
  c.textAlign='center';c.textBaseline='alphabetic';
  c.fillText('à¦¸à¦®à¦¾à¦œ à¦•à¦²à§à¦¯à¦¾à¦£ à¦¯à§à¦¬ à¦¸à¦‚à¦—à¦ à¦¨',W/2,74);
  c.fillStyle='#8b6914';c.font='italic 13px "Cormorant Garamond",Georgia';
  c.fillText('Somaj Kalyan Jubo Sangathan Â· Ramkrisnopur, Doulatpur, Kushtia Â· Est. 2025',W/2,93);
  c.fillStyle='rgba(139,105,20,0.5)';c.font='600 11px Montserrat,Arial';
  c.fillText('Developed By Saidur',W/2,109);

  c.strokeStyle=grd;c.lineWidth=1;
  c.beginPath();c.moveTo(70,122);c.lineTo(W-70,122);c.stroke();

  // Trophy
  c.font='48px serif';c.fillStyle='#c9a84c';
  c.textBaseline='middle';c.fillText('ğŸ†',W/2,168);c.textBaseline='alphabetic';

  // Title
  c.fillStyle='#7a5000';c.font='bold 35px Cinzel,serif';
  c.textAlign='center';c.fillText('CERTIFICATE OF PARTICIPATION',W/2,224);
  c.fillStyle='#8b6914';c.font='bold 19px "Hind Siliguri"';
  c.fillText('à¦…à¦‚à¦¶à¦—à§à¦°à¦¹à¦£ à¦¸à¦¾à¦°à§à¦Ÿà¦¿à¦«à¦¿à¦•à§‡à¦Ÿ',W/2,250);

  const tl=c.createLinearGradient(100,0,W-100,0);
  tl.addColorStop(0,'transparent');tl.addColorStop(0.3,'#c9a84c');
  tl.addColorStop(0.7,'#c9a84c');tl.addColorStop(1,'transparent');
  c.strokeStyle=tl;c.lineWidth=1.5;
  c.beginPath();c.moveTo(100,264);c.lineTo(W-100,264);c.stroke();

  const bx=68;
  c.textAlign='left';c.fillStyle='#444';c.font='15px "Hind Siliguri"';
  c.fillText('à¦¸à¦—à§Œà¦°à¦¬à§‡ à¦ªà§à¦°à¦®à¦¾à¦£ à¦•à¦°à¦¾ à¦¹à¦šà§à¦›à§‡ à¦¯à§‡,  /  This is to proudly certify that,',bx,302);

  c.fillStyle='#1b5e20';c.font='bold 32px "Hind Siliguri"';
  c.fillText(m.name||'-',bx,350);
  const nw=c.measureText(m.name||'-').width;
  c.strokeStyle=grd;c.lineWidth=2;
  c.beginPath();c.moveTo(bx,357);c.lineTo(bx+nw,357);c.stroke();

  c.fillStyle='#3a3a3a';c.font='14px "Hind Siliguri"';
  c.fillText(`à¦ªà§‡à¦¶à¦¾: ${m.job||'â€”'}  Â·  à¦¶à¦¿à¦•à§à¦·à¦¾: ${m.education||'â€”'}`,bx,386);
  c.fillText(`à¦—à§à¦°à¦¾à¦®: ${m.area||m.village||'â€”'}  Â·  ID: ${m.memberId||'â€”'}`,bx,408);

  c.fillStyle='#333';c.font='13.5px "Hind Siliguri"';
  wrapText(c,'à¦¸à¦®à¦¾à¦œ à¦•à¦²à§à¦¯à¦¾à¦£ à¦¯à§à¦¬ à¦¸à¦‚à¦—à¦ à¦¨à§‡à¦° à¦¬à¦¿à¦­à¦¿à¦¨à§à¦¨ à¦¸à¦¾à¦®à¦¾à¦œà¦¿à¦• à¦•à¦¾à¦°à§à¦¯à¦•à§à¦°à¦® à¦“ à¦…à¦¨à§à¦·à§à¦ à¦¾à¦¨à§‡ à¦¸à¦•à§à¦°à¦¿à¦¯à¦¼à¦­à¦¾à¦¬à§‡ à¦…à¦‚à¦¶à¦—à§à¦°à¦¹à¦£ à¦•à¦°à§‡à¦›à§‡à¦¨à¥¤ à¦¤à¦¾à¦à¦° à¦à¦‡ à¦…à¦¬à¦¦à¦¾à¦¨ à¦“ à¦‰à¦¦à§à¦¯à§‹à¦— à¦¸à¦‚à¦—à¦ à¦¨à¦•à§‡ à¦à¦—à¦¿à¦¯à¦¼à§‡ à¦¨à¦¿à¦¯à¦¼à§‡ à¦¯à§‡à¦¤à§‡ à¦¸à¦¹à¦¾à¦¯à¦¼à¦¤à¦¾ à¦•à¦°à¦›à§‡à¥¤',bx,435,590,21);
  c.fillStyle='#666';c.font='italic 12px "Cormorant Garamond",Georgia';
  wrapText(c,'has actively participated in various social programs and events of Somaj Kalyan Jubo Sangathan. His/her contribution and enthusiasm is helping the organization move forward.',bx,480,590,18);

  c.fillStyle='#1b5e20';c.font='bold 13px "Hind Siliguri"';
  c.fillText(`à¦¤à¦¾à¦°à¦¿à¦–: ${todayBn()}  /  Date: ${todayEn()}`,bx,528);

  // Photo
  const pX=W-148,pY=410,pR=76;
  c.save();c.beginPath();c.arc(pX,pY,pR,0,Math.PI*2);c.clip();
  if(photo){c.drawImage(photo,pX-pR,pY-pR,pR*2,pR*2);}
  else{c.fillStyle='#fff9e6';c.fillRect(pX-pR,pY-pR,pR*2,pR*2);c.fillStyle='#8b6914';c.font='bold 54px Arial';c.textAlign='center';c.textBaseline='middle';c.fillText(ini(m.name),pX,pY+3);}
  c.restore();
  c.strokeStyle=grd;c.lineWidth=4;c.beginPath();c.arc(pX,pY,pR+2,0,Math.PI*2);c.stroke();
  c.strokeStyle='rgba(184,134,11,0.2)';c.lineWidth=1.5;c.beginPath();c.arc(pX,pY,pR+10,0,Math.PI*2);c.stroke();

  drawQR(c,W-200,502,72,m.memberId);

  drawSig(c,100,700,'à¦¸à¦­à¦¾à¦ªà¦¤à¦¿','à¦®à§‹à¦ƒ à¦¶à¦¿à¦®à§à¦² à¦¹à§‹à¦¸à§‡à¦¨',grd);
  drawSig(c,390,700,'à¦¸à¦¾à¦§à¦¾à¦°à¦£ à¦¸à¦®à§à¦ªà¦¾à¦¦à¦•','à¦®à§‹à¦ƒ à¦œà¦¾à¦•à¦¿à¦° à¦¹à§‹à¦¸à§‡à¦¨',grd);
  drawSig(c,680,700,'à¦¸à¦¾à¦§à¦¾à¦°à¦£ à¦¸à¦®à§à¦ªà¦¾à¦¦à¦•','à¦®à§‹à¦ƒ à¦¶à§à¦­ à¦†à¦²à§€',grd);
  drawSeal(c,W-148,634,46,grd);

  const fg=c.createLinearGradient(0,H-42,0,H-18);
  fg.addColorStop(0,'#7a5000');fg.addColorStop(1,'#4a3000');
  c.fillStyle=fg;c.fillRect(38,H-42,W-76,24);
  c.fillStyle='rgba(245,224,160,0.9)';c.font='11px "Hind Siliguri"';
  c.textAlign='center';c.textBaseline='middle';
  c.fillText('à¦¯à§à¦¬à¦¶à¦•à§à¦¤à¦¿à¦‡ à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à¦¨à§‡à¦° à¦¹à¦¾à¦¤à¦¿à¦¯à¦¼à¦¾à¦°  Â·  Youth is the Instrument of Change',W/2,H-30);

  devCredit(c,W,H);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TAB SWITCH
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function showCert(id,btn){
  document.querySelectorAll('.cert-section').forEach(s=>s.classList.remove('active'));
  document.querySelectorAll('.tab').forEach(b=>b.classList.remove('active'));
  document.getElementById('sec-'+id).classList.add('active');
  if(btn)btn.classList.add('active');
  if(window._member){
    setTimeout(()=>{
      if(id==='membership')drawMembership(window._member,window._photoImg);
      else if(id==='idcard')drawIDCard(window._member,window._photoImg);
      else if(id==='volunteer')drawVolunteer(window._member,window._photoImg);
      else if(id==='participation')drawParticipation(window._member,window._photoImg);
    },50);
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DOWNLOAD
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function downloadCert(type,format){
  const map={membership:'membershipCanvas',idcard:'idCanvas',volunteer:'volunteerCanvas',participation:'participationCanvas'};
  const names={membership:'à¦¸à¦¦à¦¸à§à¦¯à¦ªà¦¦_à¦¸à¦¾à¦°à§à¦Ÿà¦¿à¦«à¦¿à¦•à§‡à¦Ÿ',idcard:'ID_à¦•à¦¾à¦°à§à¦¡',volunteer:'à¦¸à§à¦¬à§‡à¦šà§à¦›à¦¾à¦¸à§‡à¦¬à§€_à¦¸à¦¾à¦°à§à¦Ÿà¦¿à¦«à¦¿à¦•à§‡à¦Ÿ',participation:'à¦…à¦‚à¦¶à¦—à§à¦°à¦¹à¦£_à¦¸à¦¾à¦°à§à¦Ÿà¦¿à¦«à¦¿à¦•à§‡à¦Ÿ'};
  const canvas=document.getElementById(map[type]);
  const mn=(window._member?.name||'member').replace(/\s+/g,'_');
  const fname=`${names[type]}_${mn}`;
  if(format==='jpg'){
    const a=document.createElement('a');a.download=fname+'.jpg';
    a.href=canvas.toDataURL('image/jpeg',0.96);a.click();
  }else{
    try{
      const{jsPDF}=window.jspdf;
      const isCard=type==='idcard';
      let pdf;
      if(isCard){pdf=new jsPDF({orientation:'landscape',unit:'mm',format:[85.6,53.98]});pdf.addImage(canvas.toDataURL('image/jpeg',0.96),'JPEG',0,0,85.6,53.98);}
      else{pdf=new jsPDF({orientation:'landscape',unit:'mm',format:'a4'});pdf.addImage(canvas.toDataURL('image/jpeg',0.96),'JPEG',0,0,297,210);}
      pdf.save(fname+'.pdf');
    }catch(e){
      const a=document.createElement('a');a.download=fname+'.jpg';
      a.href=canvas.toDataURL('image/jpeg',0.96);a.click();
    }
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   INFO GRID
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderInfoGrid(m){
  const rows=[
    ['ğŸªª','à¦¸à¦¦à¦¸à§à¦¯ ID',m.memberId||'â€”'],['ğŸ‘¤','à¦¨à¦¾à¦®',m.name||'â€”'],
    ['ğŸ“','à¦à¦²à¦¾à¦•à¦¾',m.area||m.village||'â€”'],['ğŸ“','à¦®à§‹à¦¬à¦¾à¦‡à¦²',m.phone||'â€”'],
    ['ğŸ©¸','à¦°à¦•à§à¦¤à§‡à¦° à¦—à§à¦°à§à¦ª',m.bloodGroup||'â€”'],['ğŸ’¼','à¦ªà§‡à¦¶à¦¾',m.job||'â€”'],
    ['ğŸ“','à¦¶à¦¿à¦•à§à¦·à¦¾',m.education||'â€”'],['â­','à¦ªà¦¦à¦¬à¦¿',m.position||'à¦¸à¦¦à¦¸à§à¦¯'],
  ];
  const html=rows.map(([i,k,v])=>`<div class="info-item"><span class="info-ico">${i}</span><div class="info-txt"><strong>${k}</strong><span>${v}</span></div></div>`).join('');
  ['membershipInfo','idInfo'].forEach(id=>{const el=document.getElementById(id);if(el)el.innerHTML=html;});
}
</script>

<!-- Firebase -->
<script type="module">
import{initializeApp}from'https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js';
import{getAuth,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js';
import{getFirestore,doc,getDoc}from'https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js';

const firebaseConfig={
  apiKey:"AIzaSyDwzJgWcc4XPt4czcXpVFkHTniJFISpO7I",
  authDomain:"somaj-kallyan.firebaseapp.com",
  projectId:"somaj-kallyan",
  appId:"1:392871962816:web:0f7ebbc36a3d8c784da525"
};
const app=initializeApp(firebaseConfig);
const auth=getAuth(app);
const db=getFirestore(app);

function hideLoader(){
  const l=document.getElementById('loader');
  if(l){l.style.opacity='0';setTimeout(()=>l.style.display='none',500);}
}
function loadPhoto(url){
  return new Promise(resolve=>{
    if(!url)return resolve(null);
    const img=new Image();img.crossOrigin='anonymous';
    img.onload=()=>resolve(img);img.onerror=()=>resolve(null);img.src=url;
  });
}

onAuthStateChanged(auth,async(user)=>{
  hideLoader();
  if(!user){document.getElementById('notLoggedIn').style.display='block';return;}
  try{
    const snap=await getDoc(doc(db,'users',user.uid));
    if(!snap.exists()){document.getElementById('notLoggedIn').style.display='block';return;}
    const m={...snap.data(),uid:user.uid};

    if(m.status!=='approved'){
      document.getElementById('mainContent').style.display='block';
      document.getElementById('mainContent').innerHTML=`
        <div class="pending"><div class="ico">â³</div>
        <h4>à¦…à¦¨à§à¦®à§‹à¦¦à¦¨à§‡à¦° à¦…à¦ªà§‡à¦•à§à¦·à¦¾à¦¯à¦¼</h4>
        <p>à¦†à¦ªà¦¨à¦¾à¦° à¦¸à¦¦à¦¸à§à¦¯à¦ªà¦¦ à¦à¦–à¦¨à§‹ à¦…à¦¨à§à¦®à§‹à¦¦à¦¨ à¦¹à¦¯à¦¼à¦¨à¦¿à¥¤<br>Admin à¦…à¦¨à§à¦®à§‹à¦¦à¦¨ à¦•à¦°à¦²à§‡ à¦¸à¦¾à¦°à§à¦Ÿà¦¿à¦«à¦¿à¦•à§‡à¦Ÿ à¦ªà¦¾à¦¬à§‡à¦¨à¥¤<br><br>
        à¦¯à§‹à¦—à¦¾à¦¯à§‹à¦—: <strong style="color:var(--gold2)">01817-984524</strong></p></div>`;
      return;
    }

    window._member=m;

    // Nav
    document.getElementById('navUser').style.display='flex';
    const navAv=document.getElementById('navAv');
    if(m.photoUrl)navAv.innerHTML=`<img src="${m.photoUrl}">`;
    else navAv.textContent=(m.name||'?').charAt(0);
    document.getElementById('navName').textContent=m.name?.split(' ')[0]||'à¦¸à¦¦à¦¸à§à¦¯';

    // User card
    document.getElementById('mainContent').style.display='block';
    const bigAv=document.getElementById('bigAv');
    if(m.photoUrl)bigAv.innerHTML=`<img src="${m.photoUrl}" style="width:100%;height:100%;object-fit:cover;border-radius:50%">`;
    else bigAv.textContent=(m.name||'?').charAt(0);
    document.getElementById('uName').textContent=m.name||'-';
    document.getElementById('uInfo').textContent=`ğŸ“ ${m.area||m.village||'â€”'}  Â·  ğŸ“ ${m.phone||'â€”'}  Â·  ğŸ’¼ ${m.job||'â€”'}`;
    document.getElementById('uBadge').textContent=m.position||'à¦¸à¦¦à¦¸à§à¦¯';
    document.getElementById('uId').textContent=m.memberId?'ğŸªª '+m.memberId:'';

    const photoImg=await loadPhoto(m.photoUrl);
    window._photoImg=photoImg;

    renderInfoGrid(m);
    drawMembership(m,photoImg);

  }catch(e){
    console.error(e);
    document.getElementById('notLoggedIn').style.display='block';
  }
});
</script>
</body>
</html>